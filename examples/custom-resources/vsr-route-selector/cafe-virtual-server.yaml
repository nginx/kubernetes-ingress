apiVersion: k8s.nginx.org/v1
kind: VirtualServer
metadata:
  name: cafe
  namespace: default
spec:
  host: cafe.example.com
  tls:
    secret: cafe-secret
  server-snippets: |
    # snippet defined in VS server block
    proxy_set_header X-VS-Name "Cafe";
  routes:
  - path: /
    routeSelector:
      matchLabels:
       app: cafe
    policies:
      - name: api-key-policy
        namespace: cafe
    location-snippets: |
      # snippet defined in VS
      proxy_set_header X-VS-Name "Cafe";
    errorPages:
      - codes: [ 502, 503 ]
        redirect:
          code: 301
          url: https://nginx.org
