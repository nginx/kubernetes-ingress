<!DOCTYPE html>
<html lang="en-us">

<head>  


<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>VirtualServer and VirtualServerRoute resources | NGINX Ingress Controller</title>






<link rel="canonical" href="https://docs.nginx.com/nginx-ingress-controller/configuration/virtualserver-and-virtualserverroute-resources/">







<meta property="article:publisher" content="https://www.facebook.com/nginxinc" />
<meta property="og:image" content="https://docs.nginx.com/images/icons/NGINX-Docs-new-docs-dark-1200x630.png" />
<meta property="og:image:width" content="500" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="" />
<meta name="twitter:title" content="VirtualServer and VirtualServerRoute resources" />
<meta name="twitter:site" content="@nginx" />
<meta name="twitter:image" content="https://docs.nginx.com/images/icons/NGINX-Docs-new-docs-dark-1200x630.png" />
<meta name="twitter:creator" content="@nginx" />




<meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline'
    https://consent.trustarc.com/ https://mktg.tags.f5.com/basic/prod/utag.sync.js https://static.cloud.coveo.com/ https://*.f5.com/
    https://*.netlify.app https://gist.github.com
    https://tag.demandbase.com/pscSDsz4.min.js
    https://munchkin.brightfunnel.com/js/build/bf-munchkin.min.js
    https://www.googletagmanager.com/gtm.js
    https://www.google-analytics.com/
    https://www.google-analytics.com/analytics.js
    https://www.google-analytics.com/plugins/ua/linkid.js
    https://cdn.bizible.com/scripts/bizible.js
    https://cdn.bizible.com/xdc.js
    https://f5networksglobalprod.122.2o7.net/
    https://f5networksnginxdocs.122.2o7.net/
    ;
    worker-src 'self' blob:">



<meta property="environment" type="production" />
<meta property="buildtype" type="webdocs" />
<meta property="isServer" type="false" />


<meta name="product" content="NGINX Ingress Controller">
<meta name="version" content="">
<meta name="doc_type" content="Manual">

<link rel="shortcut icon" type="image/x-icon" href="https://docs.nginx.com/images/favicon-48x48.ico">











<link href="/nginx-ingress-controller/fontawesome/css/all.min.4a71f958af9b67180f1ece38b96217f8b2c9009f7fd8f90f299e508808fa4daf3ac3e7ec6f64e47267d1c955f7a419cc15c57ba103c9925f507af4825abdd6e8.css" integrity="sha512-SnH5WK&#43;bZxgPHs44uWIX&#43;LLJAJ9/2PkPKZ5QiAj6Ta86w&#43;fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" rel="stylesheet" type="text/css">


<link href="/nginx-ingress-controller/fontawesome/css/v4-font-face.min.5870089ba06cf03e9721f87919eaf15c961a65e071845949ed2da58c5bfbd18a714c5dab2c155f0455ebcd2f45bfd598a5e47ae19976e7aa3a51e22914eac1b6.css" integrity="sha512-WHAIm6Bs8D6XIfh5GerxXJYaZeBxhFlJ7S2ljFv70YpxTF2rLBVfBFXrzS9Fv9WYpeR64Zl256o6UeIpFOrBtg==" rel="stylesheet" type="text/css">


<link href="/nginx-ingress-controller/fontawesome/css/v5-font-face.min.81bdf1c9f8ff16b1eda613d52d868a059f16c8c6045c3d7e0a0b771622a11666cdd94b8ea62b5edb0d4b826c3a3737ec3663065fe05b56b6b871e57de73f556b.css" integrity="sha512-gb3xyfj/FrHtphPVLYaKBZ8WyMYEXD1&#43;Cgt3FiKhFmbN2UuOpite2w1Lgmw6NzfsNmMGX&#43;BbVra4ceV95z9Vaw==" rel="stylesheet" type="text/css">

  

<link href="/nginx-ingress-controller/css/bootstrap.min.3f9320327d6304dd356ac060534cfad10938431897a3cebec2515a84aaec41fdfb73d72ba39d7b5b35523cf575b432b3864bb6889d855602faef01b4dd21a734.css" integrity="sha512-P5MgMn1jBN01asBgU0z60Qk4QxiXo86&#43;wlFahKrsQf37c9cro517WzVSPPV1tDKzhku2iJ2FVgL67wG03SGnNA==" rel="stylesheet" type="text/css">



<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.10104/0/css/CoveoFullSearch.min.css" integrity="sha512-9/A9yVCU4GS6/iIwTRJKnan4Hf8gDKj3anwItN9QCsU8SixaT5xkjjWsZ/iq0TWaizhtqOLacadXJfxHlwYCcA==" crossorigin="anonymous" />


<link href="/nginx-ingress-controller/css/docs-nginx-com/nginx-site-header.min.80b10ed49ecfad93607ee771acca88d13dc958e6eecc642af3aa2b170c86b8dcce442e7b86c3e5298c95b0ab2b053a71074c2f15c28266c3a2c502275415b3a7.css" rel="stylesheet" type="text/css">


<link href="/nginx-ingress-controller/css/docs-nginx-com/style.min.2cd4748c438c49d012a5fdc6b98770223c4875fe0f89517b17423b6a5328af4d93d9d772207bfc51d9449781281e1eb8707dcc2f7467e6e24330c9b8c7c5f734.css" rel="stylesheet" type="text/css">


<link href="/nginx-ingress-controller/css/bootstrap-docs.min.8a70c94c72e3783cecd631bc1705c7843b2fdef99f1549f0bf7f774a4083173ee25974413a8206c2340c0fee9bb7a07acd41d41c78ae2280c96a2ce0faca2847.css" rel="stylesheet" type="text/css">



<link href="/nginx-ingress-controller/css/coveo.min.fce7d4df31de99e4f86510a90915820f236b8dcd02be030b27529af7ff10189f807c78cedacb91afa9d07f310a172c6046b1921832f199b9158898a7f74fa117.css" rel="stylesheet" type="text/css">



<link href="/nginx-ingress-controller/css/f5-hugo.min.d668cd51e42f94f8d4fb9a81de0dcf6329a121173422b5695c37a707ac9df6ee4f90ee81b4dbecd797731a81f593ef80d85471bda37cb9af5ce617482982aa35.css" rel="stylesheet" type="text/css">





<link href="/nginx-ingress-controller/css/highlight.min.fe5647c4b67f4b3fcf0ea60b483479d567ba1b05ee6e816439207edfa3d310dbee79536278c67d89c1db5da275bde962a10163da375f05bd19743e2a80e1ad02.css" rel="stylesheet" type="text/css">







      
<script async="async" src="https://consent.trustarc.com/notice?domain=f5.com&c=teconsent&js=nj&noticeType=bb&text=true&gtm=1" crossorigin=""></script>



<script src="https://mktg.tags.f5.com/basic/prod/utag.sync.js"></script> 







<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-K5HG9JT');</script>

</head>

<body>
   
 
<script type="text/javascript"> 
    (function(a,b,c,d) { 
        a='//mktg.tags.f5.com/basic/prod/utag.js'; 
        b=document;c='script';d=b.createElement(c);d.src=a; 
        d.type='text/java'+c;d.async=true; 
        a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})(); 
</script> 
  

  <header>
    
<div class="navbar navbar-expand navbar-dark flex-column flex-md-row bd-navbar navbar-fixed-top">
  <div class="container-fluid flex-md-row flex-column">
    <a class="navbar-brand mr-0 mr-md-2" href="/" aria-label="NGINX Docs">
      <img class="navbar-img" src="https://docs.nginx.com/images/icons/NGINX-Docs-horiz-white-type.svg" alt="NGINX Docs">
    </a>
    
      <div class="navbar navbar-nav">
            
        <div id="searchbox">
          
          <div class="CoveoSearchbox" data-placeholder='Search NGINX Docs...'></div>
        </div>
      </div>
    
    

    <ul class="navbar navbar-nav">
        <li class="nav-item-explore active">
          <button class="button navbar-button"><a href="https://www.f5.com/products" alt="Explore all products on f5.com" target="_blank">Explore All Products</a></button>
        </li>
    </ul>
  </div>
</div>


  </header>

  
    
    <nav aria-label="breadcrumb" class="breadcrumb navbar">
    <div class="nav flex-md-row">
        <ol class="breadcrumb">
            <li><a href="/" alt="NGINX Docs Home">Home</a></li>

            
            
            
            
                
            
            
                
            
            
                
            
            
            
                <li><i class="fas fa-chevron-right"></i><a href="/nginx-ingress-controller/">NGINX Ingress Controller</a></a><i class="fas fa-chevron-right"></i></li>
                
            
                <li><a href="/nginx-ingress-controller/configuration/">Configuration</a><i class="fas fa-chevron-right"></i></li>
                
            
                VirtualServer and VirtualServerRoute resources
        </ol>
    </div>
</nav>

  
    
  

  <div class="main container-fluid min-page-height" data-menu-id="/nginx-ingress-controller/configuration/virtualserver-and-virtualserverroute-resources/">
    
    
<div class="row" style="max-width: calc(100% + 30px) !important; flex-wrap: nowrap;">
  <nav class="sidenav overflow-auto col-md-3 d-none d-xl-block d-print-none align-top" style="width: 25%;">
    


<div id="sidebar-wrapper">

    <div id="sidebar" class="sidebar" aria-label="Sidebar navigation">
        <button id="sidebar-toggle-button" title="Toggle sidebar navigation" role="button" aria-controls="sidebar-content">
            <i class="fa fa-chevron-right sidebar-visible-collapsed"></i>
            <i class="fa fa-chevron-left sidebar-visible-expanded"></i>
        </button>
        <div id="sidebar-content">
            <h3>
                <a class="sidebar-title" href="https://docs.nginx.com/nginx-ingress-controller/" alt="NGINX Ingress Controller"><img
                        class="card-img-top" src="https://docs.nginx.com/images/icons/NGINX-Ingress-Controller-product-icon.svg"
                        alt="NGINX Ingress Controller">
                    NGINX Ingress Controller</a>
            </h3>
            <ul>
            
            
        
            
        
            
        
            
        
            
        
            
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                <a data-menu-id="/nginx-ingress-controller/overview/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#overview--overview"
                                    aria-controls="overview--overview">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Overview</a>
                            </li>
                        </div>
                        <div id="overview--overview" class="accordion-body collapse">
                            <div class="accordion-inner">
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/overview/about/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/overview/about/">About</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/overview/design/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/overview/design/">The design of NGINX Ingress Controller</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/overview/nginx-plus/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/overview/nginx-plus/">Extensibility with NGINX Plus</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/overview/product-telemetry/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/overview/product-telemetry/">Product telemetry</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            </div>
                        </div>
                    </div>
                </div>
                
            
                
                
                <ul class="sidebar-reg-padding">
                    <div class="accordion" id="accordion1">
                        <div class="accordion-group">
                            <div class="accordion-heading">
                                <ul>
                                    <li class="nginx-toc-link l1">
                                        <a data-menu-id="/nginx-ingress-controller/technical-specifications/"
                                            href="https://docs.nginx.com/nginx-ingress-controller/technical-specifications/">Technical specifications</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </ul>
                
                
            
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                <a data-menu-id="/nginx-ingress-controller/installation/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#installation--installation"
                                    aria-controls="installation--installation">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Installation</a>
                            </li>
                        </div>
                        <div id="installation--installation" class="accordion-body collapse">
                            <div class="accordion-inner">
                            
                            
                                
                                <div class="accordion" id="Accordion2">
                                    <div class="sidebar-l1-padding">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/installation/installing-nic/" class="accordion-toggle"
                                                            aria-expanded="false" data-toggle="collapse"
                                                            href="#installation--installation--install-nginx-ingress-controller">
                                                            <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                class="fa fa-2xs fa-fw fa-chevron-down"></i>Install NGINX Ingress Controller</a>
                                                    </li>
                                                <ul>
                                            </div>
                                            <div id="installation--installation--install-nginx-ingress-controller" class="accordion-body collapse leaf">
                                                <div class="accordion-inner">

                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/installing-nic/installation-with-helm/" href="https://docs.nginx.com/nginx-ingress-controller/installation/installing-nic/installation-with-helm/">Installation with Helm</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/installing-nic/installation-with-manifests/" href="https://docs.nginx.com/nginx-ingress-controller/installation/installing-nic/installation-with-manifests/">Installation with Manifests</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/installing-nic/installation-with-operator/" href="https://docs.nginx.com/nginx-ingress-controller/installation/installing-nic/installation-with-operator/">Installation with NGINX Ingress Operator</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/installation/build-nginx-ingress-controller/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/installation/build-nginx-ingress-controller/">Build NGINX Ingress Controller</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <div class="accordion" id="Accordion2">
                                    <div class="sidebar-l1-padding">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/installation/nic-images/" class="accordion-toggle"
                                                            aria-expanded="false" data-toggle="collapse"
                                                            href="#installation--installation--nginx-ingress-controller-images">
                                                            <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                class="fa fa-2xs fa-fw fa-chevron-down"></i>NGINX Ingress Controller images</a>
                                                    </li>
                                                <ul>
                                            </div>
                                            <div id="installation--installation--nginx-ingress-controller-images" class="accordion-body collapse leaf">
                                                <div class="accordion-inner">

                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/nic-images/get-registry-image/" href="https://docs.nginx.com/nginx-ingress-controller/installation/nic-images/get-registry-image/">Get NGINX Ingress Controller from the F5 Registry</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/nic-images/get-image-using-jwt/" href="https://docs.nginx.com/nginx-ingress-controller/installation/nic-images/get-image-using-jwt/">Get the NGINX Ingress Controller image with JWT</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/nic-images/use-aws-image/" href="https://docs.nginx.com/nginx-ingress-controller/installation/nic-images/use-aws-image/">Use the AWS Marketplace NGINX Ingress Controller image</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/nic-images/use-gcp-image/" href="https://docs.nginx.com/nginx-ingress-controller/installation/nic-images/use-gcp-image/">Use the GCP Marketplace NGINX Ingress Controller image</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/installation/run-multiple-ingress-controllers/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/installation/run-multiple-ingress-controllers/">Run multiple NGINX Ingress Controllers</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/installation/ingress-nginx/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/installation/ingress-nginx/">Migrate from Ingress-NGINX Controller to NGINX Ingress Controller</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <div class="accordion" id="Accordion2">
                                    <div class="sidebar-l1-padding">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/installation/integrations/" class="accordion-toggle"
                                                            aria-expanded="false" data-toggle="collapse"
                                                            href="#installation--installation--integrations">
                                                            <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                class="fa fa-2xs fa-fw fa-chevron-down"></i>Integrations</a>
                                                    </li>
                                                <ul>
                                            </div>
                                            <div id="installation--installation--integrations" class="accordion-body collapse leaf">
                                                <div class="accordion-inner">

                                                
                                                    
                                                    
                                                    <div class="accordion" id="Accordion3">
                                                        <div class="sidebar-l2-padding">
                                                            <div class="accordion-group sidebar-il-border">
                                                                <div class="accordion-heading">
                                                                    <ul>
                                                                        <li class="nginx-toc-link l2">
                                                                            <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-waf/" class="accordion-toggle"
                                                                                aria-expanded="false" data-toggle="collapse"
                                                                                href="#installation--integrations--nginx-app-protect-waf">
                                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>NGINX App Protect WAF</a>
                                                                        </li>
                                                                    <ul>
                                                                </div>
                                                                <div id="installation--integrations--nginx-app-protect-waf" class="accordion-body collapse leaf">
                                                                    <div class="accordion-inner">
                                                                    
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-waf/installation/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-waf/installation/">Build NGINX Ingress Controller with NGINX App Protect WAF</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-waf/configuration/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-waf/configuration/">Configuration</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-waf/compile-waf-policies/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-waf/compile-waf-policies/">Compile NGINX App Protect WAF policies using NGINX Instance Manager</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-waf/troubleshoot-app-protect-waf/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-waf/troubleshoot-app-protect-waf/">Troubleshoot NGINX App Protect WAF</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                
                                                    
                                                    
                                                    <div class="accordion" id="Accordion3">
                                                        <div class="sidebar-l2-padding">
                                                            <div class="accordion-group sidebar-il-border">
                                                                <div class="accordion-heading">
                                                                    <ul>
                                                                        <li class="nginx-toc-link l2">
                                                                            <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-waf-v5/" class="accordion-toggle"
                                                                                aria-expanded="false" data-toggle="collapse"
                                                                                href="#installation--integrations--nginx-app-protect-waf-v5">
                                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>NGINX App Protect WAF v5</a>
                                                                        </li>
                                                                    <ul>
                                                                </div>
                                                                <div id="installation--integrations--nginx-app-protect-waf-v5" class="accordion-body collapse leaf">
                                                                    <div class="accordion-inner">
                                                                    
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-waf-v5/installation/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-waf-v5/installation/">Build NGINX Ingress Controller with NGINX App Protect WAF v5</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-waf-v5/configuration/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-waf-v5/configuration/">Configuration</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                
                                                    
                                                    
                                                    <div class="accordion" id="Accordion3">
                                                        <div class="sidebar-l2-padding">
                                                            <div class="accordion-group sidebar-il-border">
                                                                <div class="accordion-heading">
                                                                    <ul>
                                                                        <li class="nginx-toc-link l2">
                                                                            <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-dos/" class="accordion-toggle"
                                                                                aria-expanded="false" data-toggle="collapse"
                                                                                href="#installation--integrations--nginx-app-protect-dos">
                                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>NGINX App Protect DoS</a>
                                                                        </li>
                                                                    <ul>
                                                                </div>
                                                                <div id="installation--integrations--nginx-app-protect-dos" class="accordion-body collapse leaf">
                                                                    <div class="accordion-inner">
                                                                    
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-dos/installation/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-dos/installation/">Build NGINX Ingress Controller with NGINX App Protect DoS</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-dos/configuration/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-dos/configuration/">Configuration</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-dos/dos-protected/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-dos/dos-protected/">DoS protected resource specification</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-dos/troubleshoot-app-protect-dos/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-dos/troubleshoot-app-protect-dos/">Troubleshoot NGINX App Protect DoS</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/integrations/f5-ingresslink/" href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/f5-ingresslink/">F5 BIG-IP</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/integrations/opentracing/" href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/opentracing/">OpenTracing</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                            
                            </div>
                        </div>
                    </div>
                </div>
                
            
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                <a data-menu-id="/nginx-ingress-controller/configuration/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#configuration--configuration"
                                    aria-controls="configuration--configuration">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Configuration</a>
                            </li>
                        </div>
                        <div id="configuration--configuration" class="accordion-body collapse">
                            <div class="accordion-inner">
                            
                            
                                
                                <div class="accordion" id="Accordion2">
                                    <div class="sidebar-l1-padding">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/configuration/global-configuration/" class="accordion-toggle"
                                                            aria-expanded="false" data-toggle="collapse"
                                                            href="#configuration--configuration--global-configuration">
                                                            <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                class="fa fa-2xs fa-fw fa-chevron-down"></i>Global configuration</a>
                                                    </li>
                                                <ul>
                                            </div>
                                            <div id="configuration--configuration--global-configuration" class="accordion-body collapse leaf">
                                                <div class="accordion-inner">

                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/global-configuration/command-line-arguments/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/global-configuration/command-line-arguments/">Command-line arguments</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/global-configuration/globalconfiguration-resource/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/global-configuration/globalconfiguration-resource/">GlobalConfiguration resource</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/global-configuration/configmap-resource/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/global-configuration/configmap-resource/">ConfigMap resources</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/global-configuration/custom-templates/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/global-configuration/custom-templates/">Custom templates</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/global-configuration/reporting-resources-status/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/global-configuration/reporting-resources-status/">Reporting resource status</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                            
                            
                                
                                <div class="accordion" id="Accordion2">
                                    <div class="sidebar-l1-padding">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/configuration/ingress-resources/" class="accordion-toggle"
                                                            aria-expanded="false" data-toggle="collapse"
                                                            href="#configuration--configuration--ingress-resources">
                                                            <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                class="fa fa-2xs fa-fw fa-chevron-down"></i>Ingress resources</a>
                                                    </li>
                                                <ul>
                                            </div>
                                            <div id="configuration--configuration--ingress-resources" class="accordion-body collapse leaf">
                                                <div class="accordion-inner">

                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/ingress-resources/basic-configuration/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/basic-configuration/">Basic configuration</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/ingress-resources/advanced-configuration-with-annotations/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/advanced-configuration-with-annotations/">Advanced configuration with Annotations</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/ingress-resources/custom-annotations/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/custom-annotations/">Custom annotations</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/ingress-resources/advanced-configuration-with-snippets/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/advanced-configuration-with-snippets/">Advanced configuration with Snippets</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/ingress-resources/cross-namespace-configuration/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/cross-namespace-configuration/">Cross-namespace configuration</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/configuration/security/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/configuration/security/">Security recommendations</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/configuration/configuration-examples/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/configuration/configuration-examples/">Configuration examples</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/configuration/policy-resource/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/configuration/policy-resource/">Policy resources</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/configuration/transportserver-resource/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/configuration/transportserver-resource/">TransportServer resources</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/configuration/virtualserver-and-virtualserverroute-resources/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/configuration/virtualserver-and-virtualserverroute-resources/">VirtualServer and VirtualServerRoute resources</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/configuration/host-and-listener-collisions/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/configuration/host-and-listener-collisions/">Host and Listener collisions</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            </div>
                        </div>
                    </div>
                </div>
                
            
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                <a data-menu-id="/nginx-ingress-controller/logging-and-monitoring/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#logging-and-monitoring--logging-and-monitoring"
                                    aria-controls="logging-and-monitoring--logging-and-monitoring">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Logging And Monitoring</a>
                            </li>
                        </div>
                        <div id="logging-and-monitoring--logging-and-monitoring" class="accordion-body collapse">
                            <div class="accordion-inner">
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/logging-and-monitoring/logging/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/logging-and-monitoring/logging/">Logging</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/logging-and-monitoring/status-page/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/logging-and-monitoring/status-page/">Status Page</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/logging-and-monitoring/prometheus/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/logging-and-monitoring/prometheus/">Prometheus</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/logging-and-monitoring/service-insight/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/logging-and-monitoring/service-insight/">Service Insight</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            </div>
                        </div>
                    </div>
                </div>
                
            
                
                
                <ul class="sidebar-reg-padding">
                    <div class="accordion" id="accordion1">
                        <div class="accordion-group">
                            <div class="accordion-heading">
                                <ul>
                                    <li class="nginx-toc-link l1">
                                        <a data-menu-id="/nginx-ingress-controller/usage-reporting/"
                                            href="https://docs.nginx.com/nginx-ingress-controller/usage-reporting/">Enable Usage Reporting</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </ul>
                
                
            
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                <a data-menu-id="/nginx-ingress-controller/troubleshooting/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#troubleshooting--troubleshooting"
                                    aria-controls="troubleshooting--troubleshooting">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Troubleshooting</a>
                            </li>
                        </div>
                        <div id="troubleshooting--troubleshooting" class="accordion-body collapse">
                            <div class="accordion-inner">
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/troubleshooting/troubleshoot-common/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/troubleshooting/troubleshoot-common/">Troubleshooting common issues</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/troubleshooting/troubleshoot-configmap-policy/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/troubleshooting/troubleshoot-configmap-policy/">Troubleshooting Policy resources</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/troubleshooting/troubleshoot-ingress/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/troubleshooting/troubleshoot-ingress/">Troubleshooting Ingress resources</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/troubleshooting/troubleshoot-virtualserver/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/troubleshooting/troubleshoot-virtualserver/">Troubleshooting VirtualServer resources</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            </div>
                        </div>
                    </div>
                </div>
                
            
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                <a data-menu-id="/nginx-ingress-controller/tutorials/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#tutorials--tutorials"
                                    aria-controls="tutorials--tutorials">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Tutorials</a>
                            </li>
                        </div>
                        <div id="tutorials--tutorials" class="accordion-body collapse">
                            <div class="accordion-inner">
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/virtual-server-with-custom-listener-ports/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/virtual-server-with-custom-listener-ports/">Configuring VirtualServer with custom HTTP and HTTPS listener ports</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/security-monitoring/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/security-monitoring/">Connect NGINX App Protect WAF to NGINX Security Monitoring</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/oidc-custom-configuration/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/oidc-custom-configuration/">Customize OIDC Configuration with NGINX Ingress Controller</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/custom-listen-ports/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/custom-listen-ports/">Customizing NGINX Ingress Controller Ports</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/ingress-path-regex-annotation/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/ingress-path-regex-annotation/">Ingresses Path Matching Using Path-Regex Annotation</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/nginx-ingress-istio/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/nginx-ingress-istio/">NGINX Ingress Controller and Istio Service Mesh</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/nginx-ingress-linkerd/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/nginx-ingress-linkerd/">NGINX Ingress Controller and Linkerd</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/nginx-ingress-osm/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/nginx-ingress-osm/">NGINX Ingress Controller and Open Service Mesh</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/nginx-dynamic-module/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/nginx-dynamic-module/">Using NGINX Ingress Controller with NGINX Dynamic Modules</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            </div>
                        </div>
                    </div>
                </div>
                
            
                
                
                <ul class="sidebar-reg-padding">
                    <div class="accordion" id="accordion1">
                        <div class="accordion-group">
                            <div class="accordion-heading">
                                <ul>
                                    <li class="nginx-toc-link l1">
                                        <a data-menu-id="/nginx-ingress-controller/releases/"
                                            href="https://docs.nginx.com/nginx-ingress-controller/releases/">Releases</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </ul>
                
                
            
                
                
                <ul class="sidebar-reg-padding">
                    <div class="accordion" id="accordion1">
                        <div class="accordion-group">
                            <div class="accordion-heading">
                                <ul>
                                    <li class="nginx-toc-link l1">
                                        <a data-menu-id="/nginx-ingress-controller/community/"
                                            href="https://docs.nginx.com/nginx-ingress-controller/community/">Community and contributing</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </ul>
                
                
            
                
                
                <ul class="sidebar-reg-padding">
                    <div class="accordion" id="accordion1">
                        <div class="accordion-group">
                            <div class="accordion-heading">
                                <ul>
                                    <li class="nginx-toc-link l1">
                                        <a data-menu-id="/nginx-ingress-controller/glossary/"
                                            href="https://docs.nginx.com/nginx-ingress-controller/glossary/">Glossary</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </ul>
                
                
            
        

            </ul>
        </div>
    
    </div>

</div>


  </nav>
  
  
  <main class="content col d-block align-top content-has-toc" role="main">
  
    
    <h1>VirtualServer and VirtualServerRoute resources</h1>

      

      
  
    <p>This document is reference material for the VirtualServer and VirtualServerRoute resources used by F5 NGINX Ingress Controller.</p>
<p>VirtualServer and VirtualServerRoute resources are load balancing configurations recommended as an alternative to the Ingress resource.</p>
<p>They enable use cases not supported with the Ingress resource, such as traffic splitting and advanced content-based routing. The resources are implemented as <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/" target="_blank" rel="noopener">Custom Resources</a>.</p>
<p>The GitHub repository has <a href="https://github.com/nginxinc/kubernetes-ingress/tree/v3.6.2/examples/custom-resources" target="_blank" rel="noopener">examples of the resources</a> for specific use cases.</p>
<hr>
<h2 
id="virtualserver-specification">VirtualServer specification  <a class="headerlink float-right" href="#virtualserver-specification" title="VirtualServer specification"><i class="fas fa-link fa-xs"></i></a>
</h2><p>The VirtualServer resource defines load balancing configuration for a domain name, such as <code>example.com</code>. Below is an example of such configuration:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">k8s.nginx.org/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">VirtualServer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">cafe</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l">cafe.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">listener</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">http</span><span class="p">:</span><span class="w"> </span><span class="l">http-8083</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">https</span><span class="p">:</span><span class="w"> </span><span class="l">https-8443</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">secret</span><span class="p">:</span><span class="w"> </span><span class="l">cafe-secret</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">gunzip</span><span class="p">:</span><span class="w"> </span><span class="kc">on</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">upstreams</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l">tea-svc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">80</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">coffee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l">coffee-svc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">80</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">routes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/tea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">tea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/coffee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">coffee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">~ ^/decaf/.*\\.jpg$</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">coffee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">= /green/tea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">tea</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>host</code></td>
          <td style="text-align: left">The host (domain name) of the server. Must be a valid subdomain as defined in RFC 1123, such as <code>my-app</code> or <code>hello.example.com</code>. When using a wildcard domain like <code>*.example.com</code> the domain must be contained in double quotes.  The <code>host</code> value needs to be unique among all Ingress and VirtualServer resources. See also <a href="/nginx-ingress-controller/configuration/handling-host-and-listener-collisions">Handling Host and Listener Collisions</a>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>listener</code></td>
          <td style="text-align: left">Sets a custom HTTP and/or HTTPS listener. Valid fields are <code>listener.http</code> and <code>listener.https</code>. Each field must reference the name of a valid listener defined in a GlobalConfiguration resource</td>
          <td style="text-align: left"><a href="#virtualserverlistener">listener</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>tls</code></td>
          <td style="text-align: left">The TLS termination configuration.</td>
          <td style="text-align: left"><a href="#virtualservertls">tls</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>gunzip</code></td>
          <td style="text-align: left">Enables or disables <a href="https://docs.nginx.com/nginx/admin-guide/web-server/compression/" target="_blank" rel="noopener">decompression</a> of gzipped responses for clients. Allowed values “on”/“off”, “true”/“false” or “yes”/“no”. If the <code>gunzip</code> value is not set, it defaults to <code>off</code>.</td>
          <td style="text-align: left"><code>boolean</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>externalDNS</code></td>
          <td style="text-align: left">The externalDNS configuration for a VirtualServer.</td>
          <td style="text-align: left"><a href="#virtualserverexternaldns">externalDNS</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>dos</code></td>
          <td style="text-align: left">A reference to a DosProtectedResource, setting this enables DOS protection of the VirtualServer.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>policies</code></td>
          <td style="text-align: left">A list of policies.</td>
          <td style="text-align: left"><a href="#virtualserverpolicy">[]policy</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>upstreams</code></td>
          <td style="text-align: left">A list of upstreams.</td>
          <td style="text-align: left"><a href="#upstream">[]upstream</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>routes</code></td>
          <td style="text-align: left">A list of routes.</td>
          <td style="text-align: left"><a href="#virtualserverroute">[]route</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>ingressClassName</code></td>
          <td style="text-align: left">Specifies which Ingress Controller must handle the VirtualServer resource.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>internalRoute</code></td>
          <td style="text-align: left">Specifies if the VirtualServer resource is an internal route or not.</td>
          <td style="text-align: left"><code>boolean</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>http-snippets</code></td>
          <td style="text-align: left">Sets a custom snippet in the http context.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>server-snippets</code></td>
          <td style="text-align: left">Sets a custom snippet in server context. Overrides the <code>server-snippets</code> ConfigMap key.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="virtualservertls">VirtualServer.TLS  <a class="headerlink float-right" href="#virtualservertls" title="VirtualServer.TLS"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The tls field defines TLS configuration for a VirtualServer. For example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">secret</span><span class="p">:</span><span class="w"> </span><span class="l">cafe-secret</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">redirect</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">enable</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>secret</code></td>
          <td style="text-align: left">The name of a secret with a TLS certificate and key. The secret must belong to the same namespace as the VirtualServer. The secret must be of the type <code>kubernetes.io/tls</code> and contain keys named <code>tls.crt</code> and <code>tls.key</code> that contain the certificate and private key as described <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/#tls" target="_blank" rel="noopener">here</a>. If the secret doesn&rsquo;t exist or is invalid, NGINX will break any attempt to establish a TLS connection to the host of the VirtualServer. If the secret is not specified but <a href="/nginx-ingress-controller/configuration/global-configuration/command-line-arguments#cmdoption-wildcard-tls-secret">wildcard TLS secret</a> is configured, NGINX will use the wildcard secret for TLS termination.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>redirect</code></td>
          <td style="text-align: left">The redirect configuration of the TLS for a VirtualServer.</td>
          <td style="text-align: left"><a href="#virtualservertlsredirect">tls.redirect</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>cert-manager</code></td>
          <td style="text-align: left">The cert-manager configuration of the TLS for a VirtualServer.</td>
          <td style="text-align: left"><a href="#virtualservertlscertmanager">tls.cert-manager</a></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="virtualservertlsredirect">VirtualServer.TLS.Redirect  <a class="headerlink float-right" href="#virtualservertlsredirect" title="VirtualServer.TLS.Redirect"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The redirect field configures a TLS redirect for a VirtualServer:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">enable</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">code</span><span class="p">:</span><span class="w"> </span><span class="m">301</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">basedOn</span><span class="p">:</span><span class="w"> </span><span class="l">scheme</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>enable</code></td>
          <td style="text-align: left">Enables a TLS redirect for a VirtualServer. The default is <code>False</code>.</td>
          <td style="text-align: left"><code>boolean</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>code</code></td>
          <td style="text-align: left">The status code of a redirect. The allowed values are: <code>301</code> , <code>302</code> , <code>307</code> , <code>308</code>.  The default is <code>301</code>.</td>
          <td style="text-align: left"><code>int</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>basedOn</code></td>
          <td style="text-align: left">The attribute of a request that NGINX will evaluate to send a redirect. The allowed values are <code>scheme</code> (the scheme of the request) or <code>x-forwarded-proto</code> (the <code>X-Forwarded-Proto</code> header of the request). The default is <code>scheme</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="virtualservertlscertmanager">VirtualServer.TLS.CertManager  <a class="headerlink float-right" href="#virtualservertlscertmanager" title="VirtualServer.TLS.CertManager"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The cert-manager field configures x509 automated Certificate management for VirtualServer resources using cert-manager (cert-manager.io). Please see the <a href="https://cert-manager.io/docs/configuration/" target="_blank" rel="noopener">cert-manager configuration documentation</a> for more information on deploying and configuring Issuers. Example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">cert-manager</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cluster-issuer</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;my-issuer-name&#34;</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>issuer</code></td>
          <td style="text-align: left">the name of an Issuer. An Issuer is a cert-manager resource which describes the certificate authority capable of signing certificates. The Issuer must be in the same namespace as the VirtualServer resource. Please note that one of <code>issuer</code> and <code>cluster-issuer</code> are required, but they are mutually exclusive - one and only one must be defined.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>cluster-issuer</code></td>
          <td style="text-align: left">the name of a ClusterIssuer. A ClusterIssuer is a cert-manager resource which describes the certificate authority capable of signing certificates. It does not matter which namespace your VirtualServer resides, as ClusterIssuers are non-namespaced resources. Please note that one of <code>issuer</code> and <code>cluster-issuer</code> are required, but they are mutually exclusive - one and only one must be defined.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>issuer-kind</code></td>
          <td style="text-align: left">The kind of the external issuer resource, for example AWSPCAIssuer. This is only necessary for out-of-tree issuers. This cannot be defined if <code>cluster-issuer</code> is also defined.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>issuer-group</code></td>
          <td style="text-align: left">The API group of the external issuer controller, for example awspca.cert-manager.io. This is only necessary for out-of-tree issuers. This cannot be defined if <code>cluster-issuer</code> is also defined.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>common-name</code></td>
          <td style="text-align: left">This field allows you to configure spec.commonName for the Certificate to be generated. This configuration adds a CN to the x509 certificate.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>duration</code></td>
          <td style="text-align: left">This field allows you to configure spec.duration field for the Certificate to be generated. Must be specified using a <a href="https://pkg.go.dev/time#ParseDuration" target="_blank" rel="noopener">Go time.Duration</a> string format, which does not allow the d (days) suffix. You must specify these values using s, m, and h suffixes instead.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>renew-before</code></td>
          <td style="text-align: left">this annotation allows you to configure spec.renewBefore field for the Certificate to be generated. Must be specified using a <a href="https://pkg.go.dev/time#ParseDuration" target="_blank" rel="noopener">Go time.Duration</a> string format, which does not allow the d (days) suffix. You must specify these values using s, m, and h suffixes instead.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>usages</code></td>
          <td style="text-align: left">This field allows you to configure spec.usages field for the Certificate to be generated. Pass a string with comma-separated values i.e. <code>key agreement,digital signature, server auth</code>. An exhaustive list of supported key usages can be found in the <a href="https://cert-manager.io/docs/reference/api-docs/#cert-manager.io/v1.KeyUsage" target="_blank" rel="noopener">the cert-manager api documentation</a>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>issue-temp-cert</code></td>
          <td style="text-align: left">When <code>true</code>, ask cert-manager for a <a href="https://cert-manager.io/docs/usage/certificate/#temporary-certificates-while-issuing" target="_blank" rel="noopener">temporary self-signed certificate</a> pending the issuance of the Certificate. This allows HTTPS-only servers to use ACME HTTP01 challenges when the TLS secret does not exist yet.</td>
          <td style="text-align: left"><code>boolean</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="virtualserverlistener">VirtualServer.Listener  <a class="headerlink float-right" href="#virtualserverlistener" title="VirtualServer.Listener"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The listener field defines a custom HTTP and/or HTTPS listener.
The respective listeners used must reference the name of a listener defined using a <a href="/nginx-ingress-controller/configuration/global-configuration/globalconfiguration-resource/">GlobalConfiguration</a> resource.
For example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">http</span><span class="p">:</span><span class="w"> </span><span class="l">http-8083</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">https</span><span class="p">:</span><span class="w"> </span><span class="l">https-8443</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>http</code></td>
          <td style="text-align: left">The name of am HTTP listener defined in a <a href="/nginx-ingress-controller/configuration/global-configuration/globalconfiguration-resource/">GlobalConfiguration</a> resource.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>https</code></td>
          <td style="text-align: left">The name of an HTTPS listener defined in a <a href="/nginx-ingress-controller/configuration/global-configuration/globalconfiguration-resource/">GlobalConfiguration</a> resource.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="virtualserverexternaldns">VirtualServer.ExternalDNS  <a class="headerlink float-right" href="#virtualserverexternaldns" title="VirtualServer.ExternalDNS"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The externalDNS field configures controlling DNS records dynamically for VirtualServer resources using <a href="https://github.com/kubernetes-sigs/external-dns" target="_blank" rel="noopener">ExternalDNS</a>. Please see the <a href="https://kubernetes-sigs.github.io/external-dns/" target="_blank" rel="noopener">ExternalDNS configuration documentation</a> for more information on deploying and configuring ExternalDNS and Providers. Example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">enable</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>enable</code></td>
          <td style="text-align: left">Enables ExternalDNS integration for a VirtualServer resource. The default is <code>false</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>labels</code></td>
          <td style="text-align: left">Configure labels to be applied to the Endpoint resources that will be consumed by ExternalDNS.</td>
          <td style="text-align: left"><code>map[string]string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>providerSpecific</code></td>
          <td style="text-align: left">Configure provider specific properties which holds the name and value of a configuration which is specific to individual DNS providers.</td>
          <td style="text-align: left"><a href="#virtualserverexternaldnsproviderspecific">[]ProviderSpecific</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>recordTTL</code></td>
          <td style="text-align: left">TTL for the DNS record. This defaults to 0 if not defined. See <a href="https://kubernetes-sigs.github.io/external-dns/v0.14.2/ttl/#providers" target="_blank" rel="noopener">the ExternalDNS TTL documentation for provider-specific defaults</a></td>
          <td style="text-align: left"><code>int64</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>recordType</code></td>
          <td style="text-align: left">The record Type that should be created, e.g. &ldquo;A&rdquo;, &ldquo;AAAA&rdquo;, &ldquo;CNAME&rdquo;. This is automatically computed based on the external endpoints if not defined.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="virtualserverexternaldnsproviderspecific">VirtualServer.ExternalDNS.ProviderSpecific  <a class="headerlink float-right" href="#virtualserverexternaldnsproviderspecific" title="VirtualServer.ExternalDNS.ProviderSpecific"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The providerSpecific field of the externalDNS block allows the specification of provider specific properties which is a list of key value pairs of configurations which are specific to individual DNS providers. Example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl">- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">my-name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">my-value</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">my-name2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">my-value2</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>name</code></td>
          <td style="text-align: left">The name of the key value pair.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>value</code></td>
          <td style="text-align: left">The value of the key value pair.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
  </tbody>
</table>

<h3 
id="virtualserverpolicy">VirtualServer.Policy  <a class="headerlink float-right" href="#virtualserverpolicy" title="VirtualServer.Policy"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The policy field references a <a href="/nginx-ingress-controller/configuration/policy-resource/">Policy resource</a> by its name and optional namespace. For example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">access-control</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>name</code></td>
          <td style="text-align: left">The name of a policy. If the policy doesn&rsquo;t exist or invalid, NGINX will respond with an error response with the <code>500</code> status code.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>namespace</code></td>
          <td style="text-align: left">The namespace of a policy. If not specified, the namespace of the VirtualServer resource is used.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="virtualserverroute">VirtualServer.Route  <a class="headerlink float-right" href="#virtualserverroute" title="VirtualServer.Route"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The route defines rules for matching client requests to actions like passing a request to an upstream. For example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/tea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">tea</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>path</code></td>
          <td style="text-align: left">The path of the route. NGINX will match it against the URI of a request. Possible values are: a prefix ( <code>/</code> , <code>/path</code> ), an exact match ( <code>=/exact/match</code> ), a case insensitive regular expression ( <code>~*^/Bar.*\.jpg</code> ) or a case sensitive regular expression ( <code>~^/foo.*\.jpg</code> ). In the case of a prefix (must start with <code>/</code> ) or an exact match (must start with <code>=</code> ), the path must not include any whitespace characters, <code>{</code> , <code>}</code> or <code>;</code>. In the case of the regex matches, all double quotes <code>&quot;</code> must be escaped and the match can&rsquo;t end in an unescaped backslash <code>\</code>. The path must be unique among the paths of all routes of the VirtualServer. Check the <a href="https://nginx.org/en/docs/http/ngx_http_core_module.html#location" target="_blank" rel="noopener">location</a> directive for more information.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>policies</code></td>
          <td style="text-align: left">A list of policies. The policies override the policies of the same type defined in the <code>spec</code> of the VirtualServer. See <a href="/nginx-ingress-controller/configuration/policy-resource/#applying-policies">Applying Policies</a> for more details.</td>
          <td style="text-align: left"><a href="#virtualserverpolicy">[]policy</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>action</code></td>
          <td style="text-align: left">The default action to perform for a request.</td>
          <td style="text-align: left"><a href="#action">action</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>dos</code></td>
          <td style="text-align: left">A reference to a DosProtectedResource, setting this enables DOS protection of the VirtualServer route.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>splits</code></td>
          <td style="text-align: left">The default splits configuration for traffic splitting. Must include at least 2 splits.</td>
          <td style="text-align: left"><a href="#split">[]split</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>matches</code></td>
          <td style="text-align: left">The matching rules for advanced content-based routing. Requires the default <code>action</code> or <code>splits</code>.  Unmatched requests will be handled by the default <code>action</code> or <code>splits</code>.</td>
          <td style="text-align: left"><a href="#match">matches</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>route</code></td>
          <td style="text-align: left">The name of a VirtualServerRoute resource that defines this route. If the VirtualServerRoute belongs to a different namespace than the VirtualServer, you need to include the namespace. For example, <code>tea-namespace/tea</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>errorPages</code></td>
          <td style="text-align: left">The custom responses for error codes. NGINX will use those responses instead of returning the error responses from the upstream servers or the default responses generated by NGINX. A custom response can be a redirect or a canned response. For example, a redirect to another URL if an upstream server responded with a 404 status code.</td>
          <td style="text-align: left"><a href="#errorpage">[]errorPage</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>location-snippets</code></td>
          <td style="text-align: left">Sets a custom snippet in the location context. Overrides the <code>location-snippets</code> ConfigMap key.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<p>* &ndash; a route must include exactly one of the following: <code>action</code>, <code>splits</code>, or <code>route</code>.</p>
<h2 
id="virtualserverroute-specification">VirtualServerRoute specification  <a class="headerlink float-right" href="#virtualserverroute-specification" title="VirtualServerRoute specification"><i class="fas fa-link fa-xs"></i></a>
</h2><p>The VirtualServerRoute resource defines a route for a VirtualServer. It can consist of one or multiple subroutes. The VirtualServerRoute is an alternative to <a href="/nginx-ingress-controller/configuration/ingress-resources/cross-namespace-configuration">Mergeable Ingress types</a>.</p>
<p>In the example below, the VirtualServer <code>cafe</code> from the namespace <code>cafe-ns</code> defines a route with the path <code>/coffee</code>, which is further defined in the VirtualServerRoute <code>coffee</code> from the namespace <code>coffee-ns</code>.</p>
<p>VirtualServer:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">k8s.nginx.org/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">VirtualServer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">cafe</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">cafe-ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l">cafe.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">upstreams</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l">tea-svc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">80</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">routes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/tea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">tea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/coffee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">route</span><span class="p">:</span><span class="w"> </span><span class="l">coffee-ns/coffee</span><span class="w">
</span></span></span></code></pre></div><p>VirtualServerRoute:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">k8s.nginx.org/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">VirtualServerRoute</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">coffee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">coffee-ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l">cafe.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">upstreams</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">latte</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l">latte-svc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">80</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">espresso</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l">espresso-svc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">80</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">subroutes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/coffee/latte</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">latte</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/coffee/espresso</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">espresso</span><span class="w">
</span></span></span></code></pre></div><p>Note that each subroute must have a <code>path</code> that starts with the same prefix (here <code>/coffee</code>), which is defined in the route of the VirtualServer. Additionally, the <code>host</code> in the VirtualServerRoute must be the same as the <code>host</code> of the VirtualServer.</p>





<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>host</code></td>
          <td style="text-align: left">The host (domain name) of the server. Must be a valid subdomain as defined in RFC 1123, such as <code>my-app</code> or <code>hello.example.com</code>. When using a wildcard domain like <code>*.example.com</code> the domain must be contained in double quotes. Must be the same as the <code>host</code> of the VirtualServer that references this resource.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>upstreams</code></td>
          <td style="text-align: left">A list of upstreams.</td>
          <td style="text-align: left"><a href="#upstream">[]upstream</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>subroutes</code></td>
          <td style="text-align: left">A list of subroutes.</td>
          <td style="text-align: left"><a href="#virtualserverroutesubroute">[]subroute</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>ingressClassName</code></td>
          <td style="text-align: left">Specifies which Ingress Controller must handle the VirtualServerRoute resource. Must be the same as the <code>ingressClassName</code> of the VirtualServer that references this resource.</td>
          <td style="text-align: left"><code>string</code>_</td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="virtualserverroutesubroute">VirtualServerRoute.Subroute  <a class="headerlink float-right" href="#virtualserverroutesubroute" title="VirtualServerRoute.Subroute"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The subroute defines rules for matching client requests to actions like passing a request to an upstream. For example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/coffee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">coffee</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>path</code></td>
          <td style="text-align: left">The path of the subroute. NGINX will match it against the URI of a request. Possible values are: a prefix ( <code>/</code> , <code>/path</code> ), an exact match ( <code>=/exact/match</code> ), a case insensitive regular expression ( <code>~*^/Bar.*\.jpg</code> ) or a case sensitive regular expression ( <code>~^/foo.*\.jpg</code> ). In the case of a prefix, the path must start with the same path as the path of the route of the VirtualServer that references this resource. In the case of an exact or regex match, the path must be the same as the path of the route of the VirtualServer that references this resource. A matching path of the route of the VirtualServer but in different type is not accepted, e.g. a regex path (<code>~/match</code>) cannot be used with a prefix path in VirtualServer (<code>/match</code>) In the case of a prefix or an exact match, the path must not include any whitespace characters, <code>{</code> , <code>}</code> or <code>;</code>.  In the case of the regex matches, all double quotes <code>&quot;</code> must be escaped and the match can&rsquo;t end in an unescaped backslash <code>\</code>. The path must be unique among the paths of all subroutes of the VirtualServerRoute.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>policies</code></td>
          <td style="text-align: left">A list of policies. The policies override <em>all</em> policies defined in the route of the VirtualServer that references this resource. The policies also override the policies of the same type defined in the <code>spec</code> of the VirtualServer. See <a href="/nginx-ingress-controller/configuration/policy-resource/#applying-policies">Applying Policies</a> for more details.</td>
          <td style="text-align: left"><a href="#virtualserverpolicy">[]policy</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>action</code></td>
          <td style="text-align: left">The default action to perform for a request.</td>
          <td style="text-align: left"><a href="#action">action</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>dos</code></td>
          <td style="text-align: left">A reference to a DosProtectedResource, setting this enables DOS protection of the VirtualServerRoute subroute.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>splits</code></td>
          <td style="text-align: left">The default splits configuration for traffic splitting. Must include at least 2 splits.</td>
          <td style="text-align: left"><a href="#split">[]split</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>matches</code></td>
          <td style="text-align: left">The matching rules for advanced content-based routing. Requires the default <code>action</code> or <code>splits</code>.  Unmatched requests will be handled by the default <code>action</code> or <code>splits</code>.</td>
          <td style="text-align: left"><a href="#match">matches</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>errorPages</code></td>
          <td style="text-align: left">The custom responses for error codes. NGINX will use those responses instead of returning the error responses from the upstream servers or the default responses generated by NGINX. A custom response can be a redirect or a canned response. For example, a redirect to another URL if an upstream server responded with a 404 status code.</td>
          <td style="text-align: left"><a href="#errorpage">[]errorPage</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>location-snippets</code></td>
          <td style="text-align: left">Sets a custom snippet in the location context. Overrides the <code>location-snippets</code> of the VirtualServer (if set) or the <code>location-snippets</code> ConfigMap key.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<p>* &ndash; a subroute must include exactly one of the following: <code>action</code> or <code>splits</code>.</p>
<h2 
id="common-virtualserver-and-virtualserverroute-specifications">Common VirtualServer and VirtualServerRoute specifications  <a class="headerlink float-right" href="#common-virtualserver-and-virtualserverroute-specifications" title="Common VirtualServer and VirtualServerRoute specifications"><i class="fas fa-link fa-xs"></i></a>
</h2><h3 
id="upstream">Upstream  <a class="headerlink float-right" href="#upstream" title="Upstream"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The upstream defines a destination for the routing configuration. For example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l">tea-svc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">subselector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l">canary</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">80</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">lb-method</span><span class="p">:</span><span class="w"> </span><span class="l">round_robin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">fail-timeout</span><span class="p">:</span><span class="w"> </span><span class="l">10s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">max-fails</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">max-conns</span><span class="p">:</span><span class="w"> </span><span class="m">32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">keepalive</span><span class="p">:</span><span class="w"> </span><span class="m">32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">connect-timeout</span><span class="p">:</span><span class="w"> </span><span class="l">30s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">read-timeout</span><span class="p">:</span><span class="w"> </span><span class="l">30s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">send-timeout</span><span class="p">:</span><span class="w"> </span><span class="l">30s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">next-upstream</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;error timeout non_idempotent&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">next-upstream-timeout</span><span class="p">:</span><span class="w"> </span><span class="l">5s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">next-upstream-tries</span><span class="p">:</span><span class="w"> </span><span class="m">10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">client-max-body-size</span><span class="p">:</span><span class="w"> </span><span class="l">2m</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">tls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">enable</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div><p><strong>Note</strong>: The WebSocket protocol is supported without any additional configuration.</p>





<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>name</code></td>
          <td style="text-align: left">The name of the upstream. Must be a valid DNS label as defined in RFC 1035. For example, <code>hello</code> and <code>upstream-123</code> are valid. The name must be unique among all upstreams of the resource.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>service</code></td>
          <td style="text-align: left">The name of a <a href="https://kubernetes.io/docs/concepts/services-networking/service/" target="_blank" rel="noopener">service</a>. The service must belong to the same namespace as the resource. If the service doesn&rsquo;t exist, NGINX will assume the service has zero endpoints and return a <code>502</code> response for requests for this upstream. For NGINX Plus only, services of type <a href="https://kubernetes.io/docs/concepts/services-networking/service/#externalname" target="_blank" rel="noopener">ExternalName</a> are also supported (check the <a href="https://github.com/nginxinc/kubernetes-ingress/tree/v3.6.2/examples/ingress-resources/externalname-services#prerequisites" target="_blank" rel="noopener">prerequisites</a> ).</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>subselector</code></td>
          <td style="text-align: left">Selects the pods within the service using label keys and values. By default, all pods of the service are selected. Note: the specified labels are expected to be present in the pods when they are created. If the pod labels are updated, NGINX Ingress Controller will not see that change until the number of the pods is changed.</td>
          <td style="text-align: left"><code>map[string]string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>use-cluster-ip</code></td>
          <td style="text-align: left">Enables using the Cluster IP and port of the service instead of the default behavior of using the IP and port of the pods. When this field is enabled, the fields that configure NGINX behavior related to multiple upstream servers (like <code>lb-method</code> and <code>next-upstream</code>) will have no effect, as NGINX Ingress Controller will configure NGINX with only one upstream server that will match the service Cluster IP.</td>
          <td style="text-align: left"><code>boolean</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>port</code></td>
          <td style="text-align: left">The port of the service. If the service doesn&rsquo;t define that port, NGINX will assume the service has zero endpoints and return a <code>502</code> response for requests for this upstream. The port must fall into the range <code>1..65535</code>.</td>
          <td style="text-align: left"><code>uint16</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>lb-method</code></td>
          <td style="text-align: left">The load <a href="https://docs.nginx.com/nginx/admin-guide/load-balancer/http-load-balancer/#choosing-a-load-balancing-method" target="_blank" rel="noopener">balancing method</a>. To use the round-robin method, specify <code>round_robin</code>. The default is specified in the <code>lb-method</code> ConfigMap key.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>fail-timeout</code></td>
          <td style="text-align: left">The time during which the specified number of unsuccessful attempts to communicate with an upstream server should happen to consider the server unavailable. See the <a href="https://nginx.org/en/docs/http/ngx_http_upstream_module.html#fail_timeout" target="_blank" rel="noopener">fail_timeout</a> parameter of the server directive. The default is set in the <code>fail-timeout</code> ConfigMap key.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>max-fails</code></td>
          <td style="text-align: left">The number of unsuccessful attempts to communicate with an upstream server that should happen in the duration set by the <code>fail-timeout</code> to consider the server unavailable. See the <a href="https://nginx.org/en/docs/http/ngx_http_upstream_module.html#max_fails" target="_blank" rel="noopener">max_fails</a> parameter of the server directive. The default is set in the <code>max-fails</code> ConfigMap key.</td>
          <td style="text-align: left"><code>int</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>max-conns</code></td>
          <td style="text-align: left">The maximum number of simultaneous active connections to an upstream server. See the <a href="https://nginx.org/en/docs/http/ngx_http_upstream_module.html#max_conns" target="_blank" rel="noopener">max_conns</a> parameter of the server directive. By default there is no limit. Note: if keepalive connections are enabled, the total number of active and idle keepalive connections to an upstream server may exceed the <code>max_conns</code> value.</td>
          <td style="text-align: left"><code>int</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>keepalive</code></td>
          <td style="text-align: left">Configures the cache for connections to upstream servers. The value <code>0</code> disables the cache. See the <a href="https://nginx.org/en/docs/http/ngx_http_upstream_module.html#keepalive" target="_blank" rel="noopener">keepalive</a> directive. The default is set in the <code>keepalive</code> ConfigMap key.</td>
          <td style="text-align: left"><code>int</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>connect-timeout</code></td>
          <td style="text-align: left">The timeout for establishing a connection with an upstream server. See the <a href="https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_connect_timeout" target="_blank" rel="noopener">proxy_connect_timeout</a> directive. The default is specified in the <code>proxy-connect-timeout</code> ConfigMap key.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>read-timeout</code></td>
          <td style="text-align: left">The timeout for reading a response from an upstream server. See the <a href="https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_read_timeout" target="_blank" rel="noopener">proxy_read_timeout</a> directive.  The default is specified in the <code>proxy-read-timeout</code> ConfigMap key.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>send-timeout</code></td>
          <td style="text-align: left">The timeout for transmitting a request to an upstream server. See the <a href="https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_send_timeout" target="_blank" rel="noopener">proxy_send_timeout</a> directive. The default is specified in the <code>proxy-send-timeout</code> ConfigMap key.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>next-upstream</code></td>
          <td style="text-align: left">Specifies in which cases a request should be passed to the next upstream server. See the <a href="https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_next_upstream" target="_blank" rel="noopener">proxy_next_upstream</a> directive. The default is <code>error timeout</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>next-upstream-timeout</code></td>
          <td style="text-align: left">The time during which a request can be passed to the next upstream server. See the <a href="https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_next_upstream_timeout" target="_blank" rel="noopener">proxy_next_upstream_timeout</a> directive. The <code>0</code> value turns off the time limit. The default is <code>0</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>next-upstream-tries</code></td>
          <td style="text-align: left">The number of possible tries for passing a request to the next upstream server. See the <a href="https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_next_upstream_tries" target="_blank" rel="noopener">proxy_next_upstream_tries</a> directive. The <code>0</code> value turns off this limit. The default is <code>0</code>.</td>
          <td style="text-align: left"><code>int</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>client-max-body-size</code></td>
          <td style="text-align: left">Sets the maximum allowed size of the client request body. See the <a href="https://nginx.org/en/docs/http/ngx_http_core_module.html#client_max_body_size" target="_blank" rel="noopener">client_max_body_size</a> directive. The default is set in the <code>client-max-body-size</code> ConfigMap key.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>tls</code></td>
          <td style="text-align: left">The TLS configuration for the Upstream.</td>
          <td style="text-align: left"><a href="#upstreamtls">tls</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>healthCheck</code></td>
          <td style="text-align: left">The health check configuration for the Upstream. See the <a href="https://nginx.org/en/docs/http/ngx_http_upstream_hc_module.html#health_check" target="_blank" rel="noopener">health_check</a> directive. Note: this feature is supported only in NGINX Plus.</td>
          <td style="text-align: left"><a href="#upstreamhealthcheck">healthcheck</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>slow-start</code></td>
          <td style="text-align: left">The slow start allows an upstream server to gradually recover its weight from 0 to its nominal value after it has been recovered or became available or when the server becomes available after a period of time it was considered unavailable. By default, the slow start is disabled. See the <a href="https://nginx.org/en/docs/http/ngx_http_upstream_module.html#slow_start" target="_blank" rel="noopener">slow_start</a> parameter of the server directive. Note: The parameter cannot be used along with the <code>random</code> , <code>hash</code> or <code>ip_hash</code> load balancing methods and will be ignored.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>queue</code></td>
          <td style="text-align: left">Configures a queue for an upstream. A client request will be placed into the queue if an upstream server cannot be selected immediately while processing the request. By default, no queue is configured. Note: this feature is supported only in NGINX Plus.</td>
          <td style="text-align: left"><a href="#upstreamqueue">queue</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>buffering</code></td>
          <td style="text-align: left">Enables buffering of responses from the upstream server. See the <a href="https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_buffering" target="_blank" rel="noopener">proxy_buffering</a> directive. The default is set in the <code>proxy-buffering</code> ConfigMap key.</td>
          <td style="text-align: left"><code>boolean</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>buffers</code></td>
          <td style="text-align: left">Configures the buffers used for reading a response from the upstream server for a single connection.</td>
          <td style="text-align: left"><a href="#upstreambuffers">buffers</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>buffer-size</code></td>
          <td style="text-align: left">Sets the size of the buffer used for reading the first part of a response received from the upstream server. See the <a href="https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_buffer_size" target="_blank" rel="noopener">proxy_buffer_size</a> directive. The default is set in the <code>proxy-buffer-size</code> ConfigMap key.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>ntlm</code></td>
          <td style="text-align: left">Allows proxying requests with NTLM Authentication. See the <a href="https://nginx.org/en/docs/http/ngx_http_upstream_module.html#ntlm" target="_blank" rel="noopener">ntlm</a> directive. In order for NTLM authentication to work, it is necessary to enable keepalive connections to upstream servers using the <code>keepalive</code> field. Note: this feature is supported only in NGINX Plus.</td>
          <td style="text-align: left"><code>boolean</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>type</code></td>
          <td style="text-align: left">The type of the upstream. Supported values are <code>http</code> and <code>grpc</code>. The default is <code>http</code>. For gRPC, it is necessary to enable HTTP/2 in the <a href="/nginx-ingress-controller/configuration/global-configuration/configmap-resource/#listeners">ConfigMap</a> and configure TLS termination in the VirtualServer.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>backup</code></td>
          <td style="text-align: left">The name of the backup service of type <a href="https://kubernetes.io/docs/concepts/services-networking/service/#externalname" target="_blank" rel="noopener">ExternalName</a>. This will be used when the primary servers are unavailable. Note: The parameter cannot be used along with the <code>random</code> , <code>hash</code> or <code>ip_hash</code> load balancing methods.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>backupPort</code></td>
          <td style="text-align: left">The port of the backup service. The backup port is required if the backup service name is provided. The port must fall into the range <code>1..65535</code>.</td>
          <td style="text-align: left"><code>uint16</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="upstreambuffers">Upstream.Buffers  <a class="headerlink float-right" href="#upstreambuffers" title="Upstream.Buffers"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The buffers field configures the buffers used for reading a response from the upstream server for a single connection:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="m">4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="l">8K</span><span class="w">
</span></span></span></code></pre></div><p>See the <a href="https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_buffers" target="_blank" rel="noopener">proxy_buffers</a> directive for additional information.</p>





<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>number</code></td>
          <td style="text-align: left">Configures the number of buffers. The default is set in the <code>proxy-buffers</code> ConfigMap key.</td>
          <td style="text-align: left"><code>int</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>size</code></td>
          <td style="text-align: left">Configures the size of a buffer. The default is set in the <code>proxy-buffers</code> ConfigMap key.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
  </tbody>
</table>

<h3 
id="upstreamtls">Upstream.TLS  <a class="headerlink float-right" href="#upstreamtls" title="Upstream.TLS"><i class="fas fa-link fa-xs"></i></a>
</h3>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>enable</code></td>
          <td style="text-align: left">Enables HTTPS for requests to upstream servers. The default is <code>False</code> , meaning that HTTP will be used. Note: by default, NGINX will not verify the upstream server certificate. To enable the verification, configure an <a href="/nginx-ingress-controller/configuration/policy-resource/#egressmtls">EgressMTLS Policy</a>.</td>
          <td style="text-align: left"><code>boolean</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="upstreamqueue">Upstream.Queue  <a class="headerlink float-right" href="#upstreamqueue" title="Upstream.Queue"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The queue field configures a queue. A client request will be placed into the queue if an upstream server cannot be selected immediately while processing the request:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="m">10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l">60s</span><span class="w">
</span></span></span></code></pre></div><p>See <a href="https://nginx.org/en/docs/http/ngx_http_upstream_module.html#queue" target="_blank" rel="noopener"><code>queue</code></a> directive for additional information.</p>
<p>Note: This feature is supported only in NGINX Plus.</p>





<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>size</code></td>
          <td style="text-align: left">The size of the queue.</td>
          <td style="text-align: left"><code>int</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>timeout</code></td>
          <td style="text-align: left">The timeout of the queue. A request cannot be queued for a period longer than the timeout. The default is <code>60s</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="upstreamhealthcheck">Upstream.Healthcheck  <a class="headerlink float-right" href="#upstreamhealthcheck" title="Upstream.Healthcheck"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The Healthcheck defines an <a href="https://docs.nginx.com/nginx/admin-guide/load-balancer/http-health-check/" target="_blank" rel="noopener">active health check</a>. In the example below we enable a health check for an upstream and configure all the available parameters, including the <code>slow-start</code> parameter combined with <a href="https://docs.nginx.com/nginx/admin-guide/load-balancer/http-health-check/#mandatory-health-checks" target="_blank" rel="noopener"><code>mandatory</code> and <code>persistent</code></a>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l">tea-svc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">80</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">slow-start</span><span class="p">:</span><span class="w"> </span><span class="l">30s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">healthCheck</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">enable</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/healthz</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">interval</span><span class="p">:</span><span class="w"> </span><span class="l">20s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">jitter</span><span class="p">:</span><span class="w"> </span><span class="l">3s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">fails</span><span class="p">:</span><span class="w"> </span><span class="m">5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">passes</span><span class="p">:</span><span class="w"> </span><span class="m">5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">8080</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">enable</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">connect-timeout</span><span class="p">:</span><span class="w"> </span><span class="l">10s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">read-timeout</span><span class="p">:</span><span class="w"> </span><span class="l">10s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">send-timeout</span><span class="p">:</span><span class="w"> </span><span class="l">10s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">headers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Host</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">my.service</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">statusMatch</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;! 500&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mandatory</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">persistent</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">keepalive-time</span><span class="p">:</span><span class="w"> </span><span class="l">60s</span><span class="w">
</span></span></span></code></pre></div><p>Note: This feature is supported only in NGINX Plus.</p>





<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>enable</code></td>
          <td style="text-align: left">Enables a health check for an upstream server. The default is <code>false</code>.</td>
          <td style="text-align: left"><code>boolean</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>path</code></td>
          <td style="text-align: left">The path used for health check requests. The default is <code>/</code>. This not configurable for gRPC type upstreams.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>interval</code></td>
          <td style="text-align: left">The interval between two consecutive health checks. The default is <code>5s</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>jitter</code></td>
          <td style="text-align: left">The time within which each health check will be randomly delayed. By default, there is no delay.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>fails</code></td>
          <td style="text-align: left">The number of consecutive failed health checks of a particular upstream server after which this server will be considered unhealthy. The default is <code>1</code>.</td>
          <td style="text-align: left"><code>integer</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>passes</code></td>
          <td style="text-align: left">The number of consecutive passed health checks of a particular upstream server after which the server will be considered healthy. The default is <code>1</code>.</td>
          <td style="text-align: left"><code>integer</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>port</code></td>
          <td style="text-align: left">The port used for health check requests. By default, the <a href="https://nginx.org/en/docs/http/ngx_http_upstream_hc_module.html#health_check_port" target="_blank" rel="noopener">server port is used</a>. Note: in contrast with the port of the upstream, this port is not a service port, but a port of a pod.</td>
          <td style="text-align: left"><code>integer</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>tls</code></td>
          <td style="text-align: left">The TLS configuration used for health check requests. By default, the <code>tls</code> field of the upstream is used.</td>
          <td style="text-align: left"><a href="#upstreamtls">upstream.tls</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>connect-timeout</code></td>
          <td style="text-align: left">The timeout for establishing a connection with an upstream server. By default, the <code>connect-timeout</code> of the upstream is used.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>read-timeout</code></td>
          <td style="text-align: left">The timeout for reading a response from an upstream server. By default, the <code>read-timeout</code> of the upstream is used.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>send-timeout</code></td>
          <td style="text-align: left">The timeout for transmitting a request to an upstream server. By default, the <code>send-timeout</code> of the upstream is used.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>headers</code></td>
          <td style="text-align: left">The request headers used for health check requests. NGINX Plus always sets the <code>Host</code> , <code>User-Agent</code> and <code>Connection</code> headers for health check requests.</td>
          <td style="text-align: left"><a href="#header">[]header</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>statusMatch</code></td>
          <td style="text-align: left">The expected response status codes of a health check. By default, the response should have status code 2xx or 3xx. Examples: <code>&quot;200&quot;</code> , <code>&quot;! 500&quot;</code> , <code>&quot;301-303 307&quot;</code>. See the documentation of the <a href="https://nginx.org/en/docs/http/ngx_http_upstream_hc_module.html?#match" target="_blank" rel="noopener">match</a> directive. This not supported for gRPC type upstreams.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>grpcStatus</code></td>
          <td style="text-align: left">The expected <a href="https://github.com/grpc/grpc/blob/master/doc/statuscodes.md#status-codes-and-their-use-in-grpc" target="_blank" rel="noopener">gRPC status code</a> of the upstream server response to the <a href="https://github.com/grpc/grpc/blob/master/doc/health-checking.md" target="_blank" rel="noopener">Check method</a>. Configure this field only if your gRPC services do not implement the gRPC health checking protocol. For example, configure <code>12</code> if the upstream server responds with <code>12 (UNIMPLEMENTED)</code> status code. Only valid on gRPC type upstreams.</td>
          <td style="text-align: left"><code>int</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>grpcService</code></td>
          <td style="text-align: left">The gRPC service to be monitored on the upstream server. Only valid on gRPC type upstreams.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>mandatory</code></td>
          <td style="text-align: left">Require every newly added server to pass all configured health checks before NGINX Plus sends traffic to it. If this is not specified, or is set to false, the server will be initially considered healthy. When combined with <a href="https://nginx.org/en/docs/http/ngx_http_upstream_module.html#slow_start" target="_blank" rel="noopener">slow-start</a>, it gives a new server more time to connect to databases and “warm up” before being asked to handle their full share of traffic.</td>
          <td style="text-align: left"><code>bool</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>persistent</code></td>
          <td style="text-align: left">Set the initial “up” state for a server after reload if the server was considered healthy before reload. Enabling persistent requires that the mandatory parameter is also set to <code>true</code>.</td>
          <td style="text-align: left"><code>bool</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>keepalive-time</code></td>
          <td style="text-align: left">Enables <a href="https://nginx.org/en/docs/http/ngx_http_upstream_module.html#keepalive" target="_blank" rel="noopener">keepalive</a> connections for health checks and specifies the time during which requests can be processed through one keepalive connection. The default is <code>60s</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="upstreamsessioncookie">Upstream.SessionCookie  <a class="headerlink float-right" href="#upstreamsessioncookie" title="Upstream.SessionCookie"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The SessionCookie field configures session persistence which allows requests from the same client to be passed to the same upstream server. The information about the designated upstream server is passed in a session cookie generated by NGINX Plus.</p>
<p>In the example below, we configure session persistence with a session cookie for an upstream and configure all the available parameters:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l">tea-svc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">80</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">sessionCookie</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">enable</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">srv_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">expires</span><span class="p">:</span><span class="w"> </span><span class="l">1h</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">domain</span><span class="p">:</span><span class="w"> </span><span class="l">.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">httpOnly</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">secure</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">samesite</span><span class="p">:</span><span class="w"> </span><span class="l">strict</span><span class="w">
</span></span></span></code></pre></div><p>See the <a href="https://nginx.org/en/docs/http/ngx_http_upstream_module.html?#sticky" target="_blank" rel="noopener"><code>sticky</code></a> directive for additional information. The session cookie corresponds to the <code>sticky cookie</code> method.</p>
<p>Note: This feature is supported only in NGINX Plus.</p>





<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>enable</code></td>
          <td style="text-align: left">Enables session persistence with a session cookie for an upstream server. The default is <code>false</code>.</td>
          <td style="text-align: left"><code>boolean</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>name</code></td>
          <td style="text-align: left">The name of the cookie.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>path</code></td>
          <td style="text-align: left">The path for which the cookie is set.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>expires</code></td>
          <td style="text-align: left">The time for which a browser should keep the cookie. Can be set to the special value <code>max</code> , which will cause the cookie to expire on <code>31 Dec 2037 23:55:55 GMT</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>domain</code></td>
          <td style="text-align: left">The domain for which the cookie is set.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>httpOnly</code></td>
          <td style="text-align: left">Adds the <code>HttpOnly</code> attribute to the cookie.</td>
          <td style="text-align: left"><code>boolean</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>secure</code></td>
          <td style="text-align: left">Adds the <code>Secure</code> attribute to the cookie.</td>
          <td style="text-align: left"><code>boolean</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>samesite</code></td>
          <td style="text-align: left">Adds the <code>SameSite</code> attribute to the cookie. The allowed values are: <code>strict</code>, <code>lax</code>, <code>none</code></td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="header">Header  <a class="headerlink float-right" href="#header" title="Header"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The header defines an HTTP Header:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Host</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">example.com</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>name</code></td>
          <td style="text-align: left">The name of the header.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>value</code></td>
          <td style="text-align: left">The value of the header.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="action">Action  <a class="headerlink float-right" href="#action" title="Action"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The action defines an action to perform for a request.</p>
<p>In the example below, client requests are passed to an upstream <code>coffee</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/coffee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">coffee</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>pass</code></td>
          <td style="text-align: left">Passes requests to an upstream. The upstream with that name must be defined in the resource.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>redirect</code></td>
          <td style="text-align: left">Redirects requests to a provided URL.</td>
          <td style="text-align: left"><a href="#actionredirect">action.redirect</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>return</code></td>
          <td style="text-align: left">Returns a preconfigured response.</td>
          <td style="text-align: left"><a href="#actionreturn">action.return</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>proxy</code></td>
          <td style="text-align: left">Passes requests to an upstream with the ability to modify the request/response (for example, rewrite the URI or modify the headers).</td>
          <td style="text-align: left"><a href="#actionproxy">action.proxy</a></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<p>* &ndash; an action must include exactly one of the following: <code>pass</code>, <code>redirect</code>, <code>return</code> or <code>proxy</code>.</p>
<h3 
id="actionredirect">Action.Redirect  <a class="headerlink float-right" href="#actionredirect" title="Action.Redirect"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The redirect action defines a redirect to return for a request.</p>
<p>In the example below, client requests are passed to a url <code>http://www.nginx.com</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">redirect</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l">http://www.nginx.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">code</span><span class="p">:</span><span class="w"> </span><span class="m">301</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>url</code></td>
          <td style="text-align: left">The URL to redirect the request to. Supported NGINX variables: <code>$scheme</code> , <code>$http_x_forwarded_proto</code> , <code>$request_uri</code> , <code>$host</code>. Variables must be enclosed in curly braces. For example: <code>${host}${request_uri}</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>code</code></td>
          <td style="text-align: left">The status code of a redirect. The allowed values are: <code>301</code> , <code>302</code> , <code>307</code> , <code>308</code>. The default is <code>301</code>.</td>
          <td style="text-align: left"><code>int</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="actionreturn">Action.Return  <a class="headerlink float-right" href="#actionreturn" title="Action.Return"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The return action defines a preconfigured response for a request.</p>
<p>In the example below, NGINX will respond with the preconfigured response for every request:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">return</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">code</span><span class="p">:</span><span class="w"> </span><span class="m">200</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">text/plain</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">body</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Hello World\n&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">headers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">x-coffee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">espresso</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>code</code></td>
          <td style="text-align: left">The status code of the response. The allowed values are: <code>2XX</code>, <code>4XX</code> or <code>5XX</code>. The default is <code>200</code>.</td>
          <td style="text-align: left"><code>int</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>type</code></td>
          <td style="text-align: left">The MIME type of the response. The default is <code>text/plain</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>body</code></td>
          <td style="text-align: left">The body of the response. Supports NGINX variables*. Variables must be enclosed in curly brackets. For example: <code>Request is ${request_uri}\n</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>headers</code></td>
          <td style="text-align: left">The custom headers of the response.</td>
          <td style="text-align: left"><a href="#actionreturnheader">[]Action.Return.Header</a></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<p>* &ndash; Supported NGINX variables: <code>$request_uri</code>, <code>$request_method</code>, <code>$request_body</code>, <code>$scheme</code>, <code>$http_</code>, <code>$args</code>, <code>$arg_</code>, <code>$cookie_</code>, <code>$host</code>, <code>$request_time</code>, <code>$request_length</code>, <code>$nginx_version</code>, <code>$pid</code>, <code>$connection</code>, <code>$remote_addr</code>, <code>$remote_port</code>, <code>$time_iso8601</code>, <code>$time_local</code>, <code>$server_addr</code>, <code>$server_port</code>, <code>$server_name</code>, <code>$server_protocol</code>, <code>$connections_active</code>, <code>$connections_reading</code>, <code>$connections_writing</code> and <code>$connections_waiting</code>.</p>
<h3 
id="actionreturnheader">Action.Return.Header  <a class="headerlink float-right" href="#actionreturnheader" title="Action.Return.Header"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The header defines an HTTP Header for a canned response in an actionReturn:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">x-coffee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">espresso</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>name</code></td>
          <td style="text-align: left">The name of the header.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>value</code></td>
          <td style="text-align: left">The value of the header.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
  </tbody>
</table>

<h3 
id="actionproxy">Action.Proxy  <a class="headerlink float-right" href="#actionproxy" title="Action.Proxy"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The proxy action passes requests to an upstream with the ability to modify the request/response (for example, rewrite the URI or modify the headers).</p>
<p>In the example below, the request URI is rewritten to <code>/</code>, and the request and the response headers are modified:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">proxy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">upstream</span><span class="p">:</span><span class="w"> </span><span class="l">coffee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">requestHeaders</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">set</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">My-Header</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">Value</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Client-Cert</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">${ssl_client_escaped_cert}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">responseHeaders</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">add</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">My-Header</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">Value</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">IC-Nginx-Version</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">${nginx_version}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">always</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">hide</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">x-internal-version</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ignore</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">Expires</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">Set-Cookie</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">pass</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">Server</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rewritePath</span><span class="p">:</span><span class="w"> </span><span class="l">/</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>upstream</code></td>
          <td style="text-align: left">The name of the upstream which the requests will be proxied to. The upstream with that name must be defined in the resource.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>requestHeaders</code></td>
          <td style="text-align: left">The request headers modifications.</td>
          <td style="text-align: left"><a href="#actionproxyrequestheaders">action.Proxy.RequestHeaders</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>responseHeaders</code></td>
          <td style="text-align: left">The response headers modifications.</td>
          <td style="text-align: left"><a href="#actionproxyresponseheaders">action.Proxy.ResponseHeaders</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>rewritePath</code></td>
          <td style="text-align: left">The rewritten URI. If the route path is a regular expression &ndash; starts with <code>~</code> &ndash; the <code>rewritePath</code> can include capture groups with <code>$1-9</code>. For example <code>$1</code> for the first group, and so on. For more information, check the <a href="https://github.com/nginxinc/kubernetes-ingress/tree/v3.6.2/examples/custom-resources/rewrites" target="_blank" rel="noopener">rewrite</a> example.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="actionproxyrequestheaders">Action.Proxy.RequestHeaders  <a class="headerlink float-right" href="#actionproxyrequestheaders" title="Action.Proxy.RequestHeaders"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The RequestHeaders field modifies the headers of the request to the proxied upstream server.</p>





<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>pass</code></td>
          <td style="text-align: left">Passes the original request headers to the proxied upstream server. See the <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_pass_request_headers" target="_blank" rel="noopener">proxy_pass_request_header</a> directive for more information. Default is true.</td>
          <td style="text-align: left"><code>bool</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>set</code></td>
          <td style="text-align: left">Allows redefining or appending fields to present request headers passed to the proxied upstream servers. See the <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_set_header" target="_blank" rel="noopener">proxy_set_header</a> directive for more information.</td>
          <td style="text-align: left"><a href="#actionproxyrequestheaderssetheader">[]header</a></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="actionproxyrequestheaderssetheader">Action.Proxy.RequestHeaders.Set.Header  <a class="headerlink float-right" href="#actionproxyrequestheaderssetheader" title="Action.Proxy.RequestHeaders.Set.Header"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The header defines an HTTP Header:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">My-Header</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">My-Value</span><span class="w">
</span></span></span></code></pre></div><p>It is possible to override the default value of the <code>Host</code> header, which NGINX Ingress Controller sets to <a href="https://nginx.org/en/docs/http/ngx_http_core_module.html#var_host" target="_blank" rel="noopener"><code>$host</code></a>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Host</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">example.com</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>name</code></td>
          <td style="text-align: left">The name of the header.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>value</code></td>
          <td style="text-align: left">The value of the header. Supports NGINX variables*. Variables must be enclosed in curly brackets. For example: <code>${scheme}</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<p>* &ndash; Supported NGINX variables: <code>$request_uri</code>, <code>$request_method</code>, <code>$request_body</code>, <code>$scheme</code>, <code>$http_</code>, <code>$args</code>, <code>$arg_</code>, <code>$cookie_</code>, <code>$host</code>, <code>$request_time</code>, <code>$request_length</code>, <code>$nginx_version</code>, <code>$pid</code>, <code>$connection</code>, <code>$remote_addr</code>, <code>$remote_port</code>, <code>$time_iso8601</code>, <code>$time_local</code>, <code>$server_addr</code>, <code>$server_port</code>, <code>$server_name</code>, <code>$server_protocol</code>, <code>$connections_active</code>, <code>$connections_reading</code>, <code>$connections_writing</code>, <code>$connections_waiting</code>, <code>$ssl_cipher</code>, <code>$ssl_ciphers</code>, <code>$ssl_client_cert</code>, <code>$ssl_client_escaped_cert</code>, <code>$ssl_client_fingerprint</code>, <code>$ssl_client_i_dn</code>, <code>$ssl_client_i_dn_legacy</code>, <code>$ssl_client_raw_cert</code>, <code>$ssl_client_s_dn</code>, <code>$ssl_client_s_dn_legacy</code>, <code>$ssl_client_serial</code>, <code>$ssl_client_v_end</code>, <code>$ssl_client_v_remain</code>, <code>$ssl_client_v_start</code>, <code>$ssl_client_verify</code>, <code>$ssl_curves</code>, <code>$ssl_early_data</code>, <code>$ssl_protocol</code>, <code>$ssl_server_name</code>, <code>$ssl_session_id</code>, <code>$ssl_session_reused</code>, <code>$jwt_claim_</code> (NGINX Plus only) and <code>$jwt_header_</code> (NGINX Plus only).</p>
<h3 
id="actionproxyresponseheaders">Action.Proxy.ResponseHeaders  <a class="headerlink float-right" href="#actionproxyresponseheaders" title="Action.Proxy.ResponseHeaders"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The ResponseHeaders field modifies the headers of the response to the client.</p>





<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>hide</code></td>
          <td style="text-align: left">The headers that will not be passed* in the response to the client from a proxied upstream server. See the <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_hide_header" target="_blank" rel="noopener">proxy_hide_header</a> directive for more information.</td>
          <td style="text-align: left"><code>[]string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>pass</code></td>
          <td style="text-align: left">Allows passing the hidden header fields* to the client from a proxied upstream server. See the <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_pass_header" target="_blank" rel="noopener">proxy_pass_header</a> directive for more information.</td>
          <td style="text-align: left"><code>[]string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>ignore</code></td>
          <td style="text-align: left">Disables processing of certain headers** to the client from a proxied upstream server. See the <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_ignore_headers" target="_blank" rel="noopener">proxy_ignore_headers</a> directive for more information.</td>
          <td style="text-align: left"><code>[]string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>add</code></td>
          <td style="text-align: left">Adds headers to the response to the client.</td>
          <td style="text-align: left"><a href="#addheader">[]addHeader</a></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<p>* &ndash; Default hidden headers are: <code>Date</code>, <code>Server</code>, <code>X-Pad</code> and <code>X-Accel-...</code>.</p>
<p>** &ndash; The following fields can be ignored: <code>X-Accel-Redirect</code>, <code>X-Accel-Expires</code>, <code>X-Accel-Limit-Rate</code>, <code>X-Accel-Buffering</code>, <code>X-Accel-Charset</code>, <code>Expires</code>, <code>Cache-Control</code>, <code>Set-Cookie</code> and <code>Vary</code>.</p>
<h3 
id="addheader">AddHeader  <a class="headerlink float-right" href="#addheader" title="AddHeader"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The addHeader defines an HTTP Header with an optional <code>always</code> field:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">My-Header</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">My-Value</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">always</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>name</code></td>
          <td style="text-align: left">The name of the header.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>value</code></td>
          <td style="text-align: left">The value of the header. Supports NGINX variables*. Variables must be enclosed in curly brackets. For example: <code>${scheme}</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>always</code></td>
          <td style="text-align: left">If set to true, add the header regardless of the response status code**. Default is false. See the <a href="http://nginx.org/en/docs/http/ngx_http_headers_module.html#add_header" target="_blank" rel="noopener">add_header</a> directive for more information.</td>
          <td style="text-align: left"><code>bool</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<p>* &ndash; Supported NGINX variables: <code>$request_uri</code>, <code>$request_method</code>, <code>$request_body</code>, <code>$scheme</code>, <code>$http_</code>, <code>$args</code>, <code>$arg_</code>, <code>$cookie_</code>, <code>$host</code>, <code>$request_time</code>, <code>$request_length</code>, <code>$nginx_version</code>, <code>$pid</code>, <code>$connection</code>, <code>$remote_addr</code>, <code>$remote_port</code>, <code>$time_iso8601</code>, <code>$time_local</code>, <code>$server_addr</code>, <code>$server_port</code>, <code>$server_name</code>, <code>$server_protocol</code>, <code>$connections_active</code>, <code>$connections_reading</code>, <code>$connections_writing</code>, <code>$connections_waiting</code>, <code>$ssl_cipher</code>, <code>$ssl_ciphers</code>, <code>$ssl_client_cert</code>, <code>$ssl_client_escaped_cert</code>, <code>$ssl_client_fingerprint</code>, <code>$ssl_client_i_dn</code>, <code>$ssl_client_i_dn_legacy</code>, <code>$ssl_client_raw_cert</code>, <code>$ssl_client_s_dn</code>, <code>$ssl_client_s_dn_legacy</code>, <code>$ssl_client_serial</code>, <code>$ssl_client_v_end</code>, <code>$ssl_client_v_remain</code>, <code>$ssl_client_v_start</code>, <code>$ssl_client_verify</code>, <code>$ssl_curves</code>, <code>$ssl_early_data</code>, <code>$ssl_protocol</code>, <code>$ssl_server_name</code>, <code>$ssl_session_id</code>, <code>$ssl_session_reused</code>, <code>$jwt_claim_</code> (NGINX Plus only) and <code>$jwt_header_</code> (NGINX Plus only).</p>
<blockquote class="note">
  <div><strong>Note:</strong><br/> If <code>always</code> is false, the response header is added only if the response status code is any of <code>200</code>, <code>201</code>, <code>204</code>, <code>206</code>, <code>301</code>, <code>302</code>, <code>303</code>, <code>304</code>, <code>307</code> or <code>308</code>.</div>
</blockquote>

<h3 
id="split">Split  <a class="headerlink float-right" href="#split" title="Split"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The split defines a weight for an action as part of the splits configuration.</p>
<p>In the example below NGINX passes 80% of requests to the upstream <code>coffee-v1</code> and the remaining 20% to <code>coffee-v2</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">splits</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">weight</span><span class="p">:</span><span class="w"> </span><span class="m">80</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">coffee-v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">weight</span><span class="p">:</span><span class="w"> </span><span class="m">20</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">coffee-v2</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>weight</code></td>
          <td style="text-align: left">The weight of an action. Must fall into the range <code>0..100</code>. The sum of the weights of all splits must be equal to <code>100</code>.</td>
          <td style="text-align: left"><code>int</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>action</code></td>
          <td style="text-align: left">The action to perform for a request.</td>
          <td style="text-align: left"><a href="#action">action</a></td>
          <td style="text-align: left">Yes</td>
      </tr>
  </tbody>
</table>

<h3 
id="match">Match  <a class="headerlink float-right" href="#match" title="Match"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The match defines a match between conditions and an action or splits.</p>
<p>In the example below, NGINX routes requests with the path <code>/coffee</code> to different upstreams based on the value of the cookie <code>user</code>:</p>
<ul>
<li><code>user=john</code> -&gt; <code>coffee-future</code></li>
<li><code>user=bob</code> -&gt; <code>coffee-deprecated</code></li>
<li>If the cookie is not set or not equal to either <code>john</code> or <code>bob</code>, NGINX routes to <code>coffee-stable</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/coffee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">matches</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">conditions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">cookie</span><span class="p">:</span><span class="w"> </span><span class="l">user</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">john</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">coffee-future</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">conditions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">cookie</span><span class="p">:</span><span class="w"> </span><span class="l">user</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">bob</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">coffee-deprecated</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">coffee-stable</span><span class="w">
</span></span></span></code></pre></div><p>In the next example, NGINX routes requests based on the value of the built-in <a href="https://nginx.org/en/docs/http/ngx_http_core_module.html#var_request_method" target="_blank" rel="noopener"><code>$request_method</code> variable</a>, which represents the HTTP method of a request:</p>
<ul>
<li>all POST requests -&gt; <code>coffee-post</code></li>
<li>all non-POST requests -&gt; <code>coffee</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/coffee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">matches</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">conditions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">variable</span><span class="p">:</span><span class="w"> </span><span class="l">$request_method</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">POST</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">coffee-post</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">coffee</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>conditions</code></td>
          <td style="text-align: left">A list of conditions. Must include at least 1 condition.</td>
          <td style="text-align: left"><a href="#condition">[]condition</a></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>action</code></td>
          <td style="text-align: left">The action to perform for a request.</td>
          <td style="text-align: left"><a href="#action">action</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>splits</code></td>
          <td style="text-align: left">The splits configuration for traffic splitting. Must include at least 2 splits.</td>
          <td style="text-align: left"><a href="#split">[]split</a></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<blockquote class="note">
  <div><strong>Note:</strong><br/> A match must include exactly one of the following: <code>action</code> or <code>splits</code>.</div>
</blockquote>

<h3 
id="condition">Condition  <a class="headerlink float-right" href="#condition" title="Condition"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The condition defines a condition in a match.</p>





<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>header</code></td>
          <td style="text-align: left">The name of a header. Must consist of alphanumeric characters or <code>-</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>cookie</code></td>
          <td style="text-align: left">The name of a cookie. Must consist of alphanumeric characters or <code>_</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>argument</code></td>
          <td style="text-align: left">The name of an argument. Must consist of alphanumeric characters or <code>_</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>variable</code></td>
          <td style="text-align: left">The name of an NGINX variable. Must start with <code>$</code>. See the list of the supported variables below the table.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>value</code></td>
          <td style="text-align: left">The value to match the condition against. How to define a value is shown below the table.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
  </tbody>
</table>

<blockquote class="note">
  <div><strong>Note:</strong><br/> a condition must include exactly one of the following: <code>header</code>, <code>cookie</code>, <code>argument</code> or <code>variable</code>.</div>
</blockquote>

<p>Supported NGINX variables: <code>$args</code>, <code>$http2</code>, <code>$https</code>, <code>$remote_addr</code>, <code>$remote_port</code>, <code>$query_string</code>, <code>$request</code>, <code>$request_body</code>, <code>$request_uri</code>, <code>$request_method</code>, <code>$scheme</code>. Find the documentation for each variable <a href="https://nginx.org/en/docs/varindex.html" target="_blank" rel="noopener">here</a>.</p>
<p>The value supports two kinds of matching:</p>
<ul>
<li><em>Case-insensitive string comparison</em>. For example:
<ul>
<li><code>john</code> &ndash; case-insensitive matching that succeeds for strings, such as <code>john</code>, <code>John</code>, <code>JOHN</code>.</li>
<li><code>!john</code> &ndash; negation of the case-insensitive matching for john that succeeds for strings, such as <code>bob</code>, <code>anything</code>, <code>''</code> (empty string).</li>
</ul>
</li>
<li><em>Matching with a regular expression</em>. Note that NGINX supports regular expressions compatible with those used by the Perl programming language (PCRE). For example:
<ul>
<li><code>~^yes</code> &ndash; a case-sensitive regular expression that matches any string that starts with <code>yes</code>. For example: <code>yes</code>, <code>yes123</code>.</li>
<li><code>!~^yes</code> &ndash; negation of the previous regular expression that succeeds for strings like <code>YES</code>, <code>Yes123</code>, <code>noyes</code>. (The negation mechanism is not part of the PCRE syntax).</li>
<li><code>~*no$</code> &ndash; a case-insensitive regular expression that matches any string that ends with <code>no</code>. For example: <code>no</code>, <code>123no</code>, <code>123NO</code>.</li>
</ul>
</li>
</ul>
<blockquote class="note">
  <div><strong>Note:</strong><br/> A value must not include any unescaped double quotes (<code>&quot;</code>) and must not end with an unescaped backslash (<code>\</code>). For example, the following are invalid values: <code>some&quot;value</code>, <code>somevalue\</code>.</div>
</blockquote>

<h3 
id="errorpage">ErrorPage  <a class="headerlink float-right" href="#errorpage" title="ErrorPage"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The errorPage defines a custom response for a route for the case when either an upstream server responds with (or NGINX generates) an error status code. The custom response can be a redirect or a canned response. See the <a href="https://nginx.org/en/docs/http/ngx_http_core_module.html#error_page" target="_blank" rel="noopener">error_page</a> directive for more information.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/coffee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">errorPages</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">codes</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">502</span><span class="p">,</span><span class="w"> </span><span class="m">503</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">redirect</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">code</span><span class="p">:</span><span class="w"> </span><span class="m">301</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l">https://nginx.org</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">codes</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">404</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">return</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">code</span><span class="p">:</span><span class="w"> </span><span class="m">200</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">body</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Original resource not found, but success!&#34;</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>codes</code></td>
          <td style="text-align: left">A list of error status codes.</td>
          <td style="text-align: left"><code>[]int</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>redirect</code></td>
          <td style="text-align: left">The redirect action for the given status codes.</td>
          <td style="text-align: left"><a href="#errorpageredirect">errorPage.Redirect</a></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>return</code></td>
          <td style="text-align: left">The canned response action for the given status codes.</td>
          <td style="text-align: left"><a href="#errorpagereturn">errorPage.Return</a></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<blockquote class="note">
  <div><strong>Note:</strong><br/> An errorPage must include exactly one of the following: <code>return</code> or <code>redirect</code>.</div>
</blockquote>

<h3 
id="errorpageredirect">ErrorPage.Redirect  <a class="headerlink float-right" href="#errorpageredirect" title="ErrorPage.Redirect"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The redirect defines a redirect for an errorPage.</p>
<p>In the example below, NGINX responds with a redirect when a response from an upstream server has a 404 status code.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">codes</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">404</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">redirect</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">code</span><span class="p">:</span><span class="w"> </span><span class="m">301</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l">${scheme}://cafe.example.com/error.html</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>code</code></td>
          <td style="text-align: left">The status code of a redirect. The allowed values are: <code>301</code> , <code>302</code> , <code>307</code> , <code>308</code>.  The default is <code>301</code>.</td>
          <td style="text-align: left"><code>int</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>url</code></td>
          <td style="text-align: left">The URL to redirect the request to. Supported NGINX variables: <code>$scheme</code> and <code>$http_x_forwarded_proto</code>. Variables must be enclosed in curly braces. For example: <code>${scheme}</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
  </tbody>
</table>

<h3 
id="errorpagereturn">ErrorPage.Return  <a class="headerlink float-right" href="#errorpagereturn" title="ErrorPage.Return"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The return defines a canned response for an errorPage.</p>
<p>In the example below, NGINX responds with a canned response when a response from an upstream server has either 401 or 403 status code.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">codes</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">401</span><span class="p">,</span><span class="w"> </span><span class="m">403</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">return</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">code</span><span class="p">:</span><span class="w"> </span><span class="m">200</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">application/json</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">body</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">    {\&#34;msg\&#34;: \&#34;You don&#39;t have permission to do this\&#34;}</span><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">headers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">x-debug-original-statuses</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">${upstream_status}</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>code</code></td>
          <td style="text-align: left">The status code of the response. The default is the status code of the original response.</td>
          <td style="text-align: left"><code>int</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>type</code></td>
          <td style="text-align: left">The MIME type of the response. The default is <code>text/html</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>body</code></td>
          <td style="text-align: left">The body of the response. Supported NGINX variable: <code>$upstream_status</code> . Variables must be enclosed in curly braces. For example: <code>${upstream_status}</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>headers</code></td>
          <td style="text-align: left">The custom headers of the response.</td>
          <td style="text-align: left"><a href="#errorpagereturnheader">[]errorPage.Return.Header</a></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h3 
id="errorpagereturnheader">ErrorPage.Return.Header  <a class="headerlink float-right" href="#errorpagereturnheader" title="ErrorPage.Return.Header"><i class="fas fa-link fa-xs"></i></a>
</h3><p>The header defines an HTTP Header for a canned response in an errorPage:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">x-debug-original-statuses</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">${upstream_status}</span><span class="w">
</span></span></span></code></pre></div>




<table class="table table-striped table-bordered table-responsive">
  <thead>
      <tr>
          <th style="text-align: left">Field</th>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Type</th>
          <th style="text-align: left">Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>name</code></td>
          <td style="text-align: left">The name of the header.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">Yes</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>value</code></td>
          <td style="text-align: left">The value of the header. Supported NGINX variable: <code>$upstream_status</code> . Variables must be enclosed in curly braces. For example: <code>${upstream_status}</code>.</td>
          <td style="text-align: left"><code>string</code></td>
          <td style="text-align: left">No</td>
      </tr>
  </tbody>
</table>

<h2 
id="using-virtualserver-and-virtualserverroute">Using VirtualServer and VirtualServerRoute  <a class="headerlink float-right" href="#using-virtualserver-and-virtualserverroute" title="Using VirtualServer and VirtualServerRoute"><i class="fas fa-link fa-xs"></i></a>
</h2><p>You can use the usual <code>kubectl</code> commands to work with VirtualServer and VirtualServerRoute resources, similar to Ingress resources.</p>
<p>For example, the following command creates a VirtualServer resource defined in <code>cafe-virtual-server.yaml</code> with the name <code>cafe</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -f cafe-virtual-server.yaml
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">virtualserver.k8s.nginx.org &#34;cafe&#34; created
</span></span></code></pre></div><p>You can get the resource by running:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl get virtualserver cafe
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">NAME   STATE   HOST                   IP            PORTS      AGE
</span></span><span class="line"><span class="cl">cafe   Valid   cafe.example.com       12.13.23.123  [80,443]   3m
</span></span></code></pre></div><p>In <code>kubectl get</code> and similar commands, you can use the short name <code>vs</code> instead of <code>virtualserver</code>.</p>
<p>Similarly, for VirtualServerRoute you can use <code>virtualserverroute</code> or the short name <code>vsr</code>.</p>
<h3 
id="using-snippets">Using Snippets  <a class="headerlink float-right" href="#using-snippets" title="Using Snippets"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Snippets allow you to insert raw NGINX config into different contexts of NGINX configuration. In the example below, we use snippets to configure several NGINX features in a VirtualServer:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">k8s.nginx.org/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">VirtualServer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">cafe</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">cafe</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">http-snippets</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">    limit_req_zone $binary_remote_addr zone=mylimit:10m rate=1r/s;
</span></span></span><span class="line"><span class="cl"><span class="sd">    proxy_cache_path /tmp keys_zone=one:10m;</span><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l">cafe.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">secret</span><span class="p">:</span><span class="w"> </span><span class="l">cafe-secret</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">server-snippets</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">    limit_req zone=mylimit burst=20;</span><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">upstreams</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l">tea-svc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">80</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">coffee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l">coffee-svc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">80</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">routes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/tea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">location-snippets</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">      proxy_cache one;
</span></span></span><span class="line"><span class="cl"><span class="sd">      proxy_cache_valid 200 10m;</span><span class="w">      
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">tea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/coffee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">coffee</span><span class="w">
</span></span></span></code></pre></div><p>For additional information, view the <a href="/nginx-ingress-controller/configuration/ingress-resources/advanced-configuration-with-snippets/">Advanced configuration with Snippets</a> topic.</p>
<h3 
id="validation">Validation  <a class="headerlink float-right" href="#validation" title="Validation"><i class="fas fa-link fa-xs"></i></a>
</h3><p>Two types of validation are available for VirtualServer and VirtualServerRoute resources:</p>
<ul>
<li><em>Structural validation</em> by the <code>kubectl</code> and Kubernetes API server.</li>
<li><em>Comprehensive validation</em> by NGINX Ingress Controller.</li>
</ul>
<h4 
id="structural-validation">Structural Validation  <a class="headerlink float-right" href="#structural-validation" title="Structural Validation"><i class="fas fa-link fa-xs"></i></a>
</h4><p>The custom resource definitions for VirtualServer and VirtualServerRoute include structural OpenAPI schema which describes the type of every field of those resources.</p>
<p>If you try to create (or update) a resource that violates the structural schema (for example, you use a string value for the port field of an upstream), <code>kubectl</code> and Kubernetes API server will reject such a resource:</p>
<ul>
<li>
<p>Example of <code>kubectl</code> validation:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -f cafe-virtual-server.yaml
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">error: error validating &#34;cafe-virtual-server.yaml&#34;: error validating data: ValidationError(VirtualServer.spec.upstreams[0].port): invalid type for org.nginx.k8s.v1.VirtualServer.spec.upstreams.port: got &#34;string&#34;, expected &#34;integer&#34;; if you choose to ignore these errors, turn validation off with --validate=false
</span></span></code></pre></div></li>
<li>
<p>Example of Kubernetes API server validation:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -f cafe-virtual-server.yaml --validate<span class="o">=</span><span class="nb">false</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">The VirtualServer &#34;cafe&#34; is invalid: []: Invalid value: map[string]interface {}{ ... }: validation failure list:
</span></span><span class="line"><span class="cl">spec.upstreams.port in body must be of type integer: &#34;string&#34;
</span></span></code></pre></div></li>
</ul>
<p>If a resource is not rejected (it doesn&rsquo;t violate the structural schema), NGINX Ingress Controller will validate it further.</p>
<h4 
id="comprehensive-validation">Comprehensive Validation  <a class="headerlink float-right" href="#comprehensive-validation" title="Comprehensive Validation"><i class="fas fa-link fa-xs"></i></a>
</h4><p>NGINX Ingress Controller validates the fields of the VirtualServer and VirtualServerRoute resources. If a resource is invalid, NGINX Ingress Controller will reject it: the resource will continue to exist in the cluster, but NGINX Ingress Controller will ignore it.</p>
<p>You can check if NGINX Ingress Controller successfully applied the configuration for a VirtualServer. For our example <code>cafe</code> VirtualServer, we can run:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl describe vs cafe
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">Events:
</span></span><span class="line"><span class="cl">  Type    Reason          Age   From                      Message
</span></span><span class="line"><span class="cl">  ----    ------          ----  ----                      -------
</span></span><span class="line"><span class="cl">  Normal  AddedOrUpdated  16s   nginx-ingress-controller  Configuration for default/cafe was added or updated
</span></span></code></pre></div><p>Note how the events section includes a Normal event with the AddedOrUpdated reason that informs us that the configuration was successfully applied.</p>
<p>If you create an invalid resource, NGINX Ingress Controller will reject it and emit a Rejected event. For example, if you create a VirtualServer <code>cafe</code> with two upstream with the same name <code>tea</code>, you will get:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl describe vs cafe
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">Events:
</span></span><span class="line"><span class="cl">  Type     Reason    Age   From                      Message
</span></span><span class="line"><span class="cl">  ----     ------    ----  ----                      -------
</span></span><span class="line"><span class="cl">  Warning  Rejected  12s   nginx-ingress-controller  VirtualServer default/cafe is invalid and was rejected: spec.upstreams[1].name: Duplicate value: &#34;tea&#34;
</span></span></code></pre></div><p>Note how the events section includes a Warning event with the Rejected reason.</p>
<p>Additionally, this information is also available in the <code>status</code> field of the VirtualServer resource. Note the Status section of the VirtualServer:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl describe vs cafe
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">Status:
</span></span><span class="line"><span class="cl">  External Endpoints:
</span></span><span class="line"><span class="cl">    Ip:        12.13.23.123
</span></span><span class="line"><span class="cl">    Ports:     [80,443]
</span></span><span class="line"><span class="cl">  Message:  VirtualServer default/cafe is invalid and was rejected: spec.upstreams[1].name: Duplicate value: &#34;tea&#34;
</span></span><span class="line"><span class="cl">  Reason:   Rejected
</span></span><span class="line"><span class="cl">  State:    Invalid
</span></span></code></pre></div><p>NGINX Ingress Controller validates VirtualServerRoute resources in a similar way.</p>
<p><strong>Note</strong>: If you make an existing resource invalid, NGINX Ingress Controller will reject it and remove the corresponding configuration from NGINX.</p>
<h2 
id="customization-using-configmap">Customization using ConfigMap  <a class="headerlink float-right" href="#customization-using-configmap" title="Customization using ConfigMap"><i class="fas fa-link fa-xs"></i></a>
</h2><p>You can customize the NGINX configuration for VirtualServer and VirtualServerRoutes resources using the <a href="/nginx-ingress-controller/configuration/global-configuration/configmap-resource">ConfigMap</a>. Most of the ConfigMap keys are supported, with the following exceptions:</p>
<ul>
<li><code>proxy-hide-headers</code></li>
<li><code>proxy-pass-headers</code></li>
<li><code>hsts</code></li>
<li><code>hsts-max-age</code></li>
<li><code>hsts-include-subdomains</code></li>
<li><code>hsts-behind-proxy</code></li>
<li><code>redirect-to-https</code></li>
<li><code>ssl-redirect</code></li>
</ul>

    
  <hr>
    

	
<div class="container flex">
	<ul class="next-prev-icon">

		
		
		<li style="flex:1; text-align: left; white-space: nowrap;"><a href="https://docs.nginx.com/nginx-ingress-controller/configuration/transportserver-resource/" class="" title="Previous -- TransportServer resources "><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M23.378 46.5L1.94 25.06C1.80067 24.9209 1.69014 24.7556 1.61472 24.5738C1.53931 24.3919 1.50049 24.1969 1.50049 24C1.50049 23.8031 1.53931 23.6081 1.61472 23.4262C1.69014 23.2444 1.80067 23.0791 1.94 22.94L23.378 1.5" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M45.878 46.5L24.44 25.06C24.3007 24.9209 24.1901 24.7556 24.1147 24.5738C24.0393 24.3919 24.0005 24.1969 24.0005 24C24.0005 23.8031 24.0393 23.6081 24.1147 23.4262C24.1901 23.2444 24.3007 23.0791 24.44 22.94L45.878 1.5" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a></li>
		

		
			<li style="flex:1; text-align: right; white-space: nowrap;"><a href="https://docs.nginx.com/nginx-ingress-controller/configuration/host-and-listener-collisions/" class="" title="Next -- Host and Listener collisions"><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M24.622 1.5L46.06 22.94C46.1993 23.0791 46.3099 23.2444 46.3853 23.4262C46.4607 23.6081 46.4995 23.8031 46.4995 24C46.4995 24.1969 46.4607 24.3919 46.3853 24.5738C46.3099 24.7556 46.1993 24.9209 46.06 25.06L24.622 46.5" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M2.122 1.5L23.56 22.94C23.6993 23.0791 23.8099 23.2444 23.8853 23.4262C23.9607 23.6081 23.9995 23.8031 23.9995 24C23.9995 24.1969 23.9607 24.3919 23.8853 24.5738C23.8099 24.7556 23.6993 24.9209 23.56 25.06L2.122 46.5" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a></li>
		
		</ul>
	</div>

    
  </main>
  
    
      <div class="col-md-3 d-none d-xl-block d-print-none nginx-toc align-top" style="width: 25%;">
      <nav class="bd-links" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <h3 class="bd-toc-link">What's on This Page</h3>
    
      
        <nav id="TableOfContents">
  <ul>
    <li><a href="#virtualserver-specification">VirtualServer specification</a>
      <ul>
        <li><a href="#virtualservertls">VirtualServer.TLS</a></li>
        <li><a href="#virtualservertlsredirect">VirtualServer.TLS.Redirect</a></li>
        <li><a href="#virtualservertlscertmanager">VirtualServer.TLS.CertManager</a></li>
        <li><a href="#virtualserverlistener">VirtualServer.Listener</a></li>
        <li><a href="#virtualserverexternaldns">VirtualServer.ExternalDNS</a></li>
        <li><a href="#virtualserverexternaldnsproviderspecific">VirtualServer.ExternalDNS.ProviderSpecific</a></li>
        <li><a href="#virtualserverpolicy">VirtualServer.Policy</a></li>
        <li><a href="#virtualserverroute">VirtualServer.Route</a></li>
      </ul>
    </li>
    <li><a href="#virtualserverroute-specification">VirtualServerRoute specification</a>
      <ul>
        <li><a href="#virtualserverroutesubroute">VirtualServerRoute.Subroute</a></li>
      </ul>
    </li>
    <li><a href="#common-virtualserver-and-virtualserverroute-specifications">Common VirtualServer and VirtualServerRoute specifications</a>
      <ul>
        <li><a href="#upstream">Upstream</a></li>
        <li><a href="#upstreambuffers">Upstream.Buffers</a></li>
        <li><a href="#upstreamtls">Upstream.TLS</a></li>
        <li><a href="#upstreamqueue">Upstream.Queue</a></li>
        <li><a href="#upstreamhealthcheck">Upstream.Healthcheck</a></li>
        <li><a href="#upstreamsessioncookie">Upstream.SessionCookie</a></li>
        <li><a href="#header">Header</a></li>
        <li><a href="#action">Action</a></li>
        <li><a href="#actionredirect">Action.Redirect</a></li>
        <li><a href="#actionreturn">Action.Return</a></li>
        <li><a href="#actionreturnheader">Action.Return.Header</a></li>
        <li><a href="#actionproxy">Action.Proxy</a></li>
        <li><a href="#actionproxyrequestheaders">Action.Proxy.RequestHeaders</a></li>
        <li><a href="#actionproxyrequestheaderssetheader">Action.Proxy.RequestHeaders.Set.Header</a></li>
        <li><a href="#actionproxyresponseheaders">Action.Proxy.ResponseHeaders</a></li>
        <li><a href="#addheader">AddHeader</a></li>
        <li><a href="#split">Split</a></li>
        <li><a href="#match">Match</a></li>
        <li><a href="#condition">Condition</a></li>
        <li><a href="#errorpage">ErrorPage</a></li>
        <li><a href="#errorpageredirect">ErrorPage.Redirect</a></li>
        <li><a href="#errorpagereturn">ErrorPage.Return</a></li>
        <li><a href="#errorpagereturnheader">ErrorPage.Return.Header</a></li>
      </ul>
    </li>
    <li><a href="#using-virtualserver-and-virtualserverroute">Using VirtualServer and VirtualServerRoute</a>
      <ul>
        <li><a href="#using-snippets">Using Snippets</a></li>
        <li><a href="#validation">Validation</a></li>
      </ul>
    </li>
    <li><a href="#customization-using-configmap">Customization using ConfigMap</a></li>
  </ul>
</nav>
      
    
  </div>
</nav>
      </div>
    
  
</div>





  </div>

  <footer>

    
    <footer id="footer">
   <div class="container-fluid">

       <div class="row align-items-center">

         <div class="col-md-6 d-md-flex">
             <img class="nginx-logo-footer" src="https://docs.nginx.com/images/icons/NGINX-Part-of-F5-horiz-all-white-525x208@2x.png"/>
         </div>

         
         <div class="col-md d-flex footer-text">
           <div class="col-xl d-none d-md-block align-self-center text-semibold align-right">
             <span>Found a bug? Looking for something new?</span>
           </div>
           <div class="col-lg d-none d-md-block pl-0">
             <button class="button footer-button"><a href="https://docs.nginx.com/feedback/" alt="Select if you have feedback">Let Us Know</a></button>
           </div>
         </div>
         

       </div>


       
       <div class="row d-print-none d-none d-md-flex">
         <div class="col-md-3 d-none d-md-block">
           <span class="footer-head">Company</span>
           <ul class="footer-text">
             <li><a href="https://www.f5.com/go/product/welcome-to-nginx" target="_blank" alt="Select to learn about F5 NGINX">About F5 NGINX</a></li>
             <li><a href="https://www.f5.com/company/events" target="_blank" alt="Select to learn about F5 events">Events</a></li>
           </ul>
           <br />
           <span class="footer-head">Resources</span>
           <ul class="footer-text">
             <li><a href="https://www.f5.com/company/blog/nginx" target="_blank" alt="Select to visit the F5 NGINX blog" >Blog</a></li>
             <li><a href="https://www.f5.com/go/faq/nginx-faq" target="_blank" alt="Select to visit the F5 NGINX frequently asked questions page" >FAQ</a></li>
             <li><a href="https://www.f5.com/services" target="_blank" alt="Select to learn about F5 NGINX Support">Professional Services</a></li>
             <li><a href="https://www.f5.com/learn/training" target="_blank" alt="Select to learn about F5 training offerings" >Training</a></li>
           </ul>
         </div>

         <div class="col-md-3 d-none d-md-block">
           <span class="footer-head">Products</span>
             <ul class="footer-text">
                 <li><a title="F5 NGINX Plus" aria-label="F5 NGINX Plus" href="https://www.f5.com/products/nginx/nginx-plus">F5 NGINX Plus</a></li>
                 <li><a title="F5 NGINX App Protect" aria-label="F5 NGINX App Protect" href="https://www.f5.com/products/nginx/nginx-app-protect">F5 NGINX App Protect</a></li>
                 <li><a title="F5 NGINX Instance Manager" aria-label="F5 NGINX Instance Manager" href="https://www.f5.com/products/nginx/instance-manager">F5 NGINX Instance Manager</a></li>
                 <li><a title="F5 NGINX Ingress Controller" aria-label="F5 NGINX Ingress Controller" href="https://www.f5.com/products/nginx/nginx-ingress-controller">F5 NGINX Ingress Controller</a></li>
                 <li><a title="F5 NGINX Gateway Fabric" aria-label="F5 NGINX Gateway Fabric" href="https://www.f5.com/products/nginx/nginx-gateway-fabric">F5 NGINX Gateway Fabric</a></li>
                 <li><a title="F5 NGINXaaS for Azure" aria-label="F5 NGINXaaS for Azure" href="https://www.f5.com/products/nginx/f5-nginxaas-for-azure">F5 NGINXaaS for Azure</a></li>
             </ul>
         </div>

         <div class="col-md-3 d-none d-md-block">
           <span class="footer-head">NGINX on GitHub</span>
           <ul class="footer-text">
             <li><a title="NGINX Open Source" aria-label="NGINX Open Source" href="https://github.com/nginx/nginx"><span class="inner">NGINX Open Source</span></a></li>
             <li><a title="NGINX Unit" aria-label="NGINX Unit" href="https://github.com/nginx/unit"><span class="inner">NGINX Unit</span></a></li>
             <li><a title="NGINX Amplify" aria-label="NGINX Amplify" href="https://github.com/nginxinc/nginx-amplify-agent"><span class="inner">NGINX Amplify</span></a></li>
             <li><a title="NGINX Agent" aria-label="NGINX Agent" href="https://github.com/nginx/Agent"><span class="inner">NGINX Agent</span></a></li>
             <li><a title="NGINX Kubernetes Ingress Controller" aria-label="NGINX Kubernetes Ingress Controller" href="https://github.com/nginxinc/kubernetes-ingress"><span class="inner">NGINX Kubernetes Ingress Controller</span></a></li>
             <li><a title="NGINX Gateway Fabric" aria-label="NGINX Gateway Fabric" href="https://github.com/nginxinc/nginx-gateway-fabric"><span class="inner">NGINX Gateway Fabric</span></a></li>
         </ul>
         </div>

         <div class="col-md-2 d-none d-md-block">
           <span class="footer-head">Social</span>
               <ul class="footer-social">
                 <li><a href="https://www.facebook.com/nginxinc" title="facebook" aria-label="facebook" target="_blank" rel="noreferrer"><i class="fa-brands fa-facebook" aria-hidden="true"></i>
                  </a></li>
                 <li><a href="https://twitter.com/nginx" title="X" aria-label="x" target="_blank" rel="noreferrer"><i class="fa-brands fa-x-twitter" aria-hidden="true"></i></a></li>
                 <li><a href="https://www.linkedin.com/company/nginx" title="linkedin" aria-label="linkedin" target="_blank" rel="noreferrer"><i class="fa-brands fa-linkedin" aria-hidden="true"></i>
                  </a></li>
                 <li><a href="https://www.youtube.com/user/NginxInc" title="youtube" aria-label="youtube" target="_blank" rel="noreferrer" alt="NGINX Youtube Channel"><i class="fa-brands fa-square-youtube" aria-hidden="true"></i>
                  </a></li>
               </ul>
         </div>
       </div>
       
       <div class="site-info footer-text">

           <div class="text-center">
           <p><a href="https://www.f5.com/"><img class="f5-logo-footer" src="https://docs.nginx.com/images/icons/Logo_F5.svg" alt="F5 logo"></a>
              ©2024 F5, Inc. All rights reserved.</p><p><a href="https://www.f5.com/company/policies/trademarks" rel="noopener" target="_blank">Trademarks</a>  <a href="https://www.f5.com/company/policies" rel="noopener" target="_blank">Policies</a> <a href="https://docs.nginx.com/ossc">Open Source Components</a>  <a href="https://www.f5.com/company/policies/privacy-notice" rel="noopener" target="_blank">Privacy</a>  <a href="https://www.f5.com/company/policies/F5-California-privacy-summary" rel="noopener" target="_blank">California Privacy</a>  <a href="https://www.f5.com/company/policies/privacy-notice#no-sell" rel="noopener" target="_blank">Do Not Sell My Personal Information</a>  <span id="teconsent"></span></p>
           </div>

       </div>
   </div>
</footer>

    

  </footer>


<script src="/nginx-ingress-controller/js/jquery-3-6-4.min.js" type="text/javascript" integrity=""></script>


<script src="/nginx-ingress-controller/js/kube.min.a3a07cceb64989e2f0bf41653ab4d8346ba4312270eb5cc80d6afad3bf30a0ca9768aaa2559cb582e663332c541edab6a4068ef2e88b739fa425e2e870eb0aff.js" type="text/javascript" integrity="sha512-o6B8zrZJieLwv0FlOrTYNGukMSJw61zIDWr6078woMqXaKqiVZy1guZjMyxUHtq2pAaO8uiLc5&#43;kJeLocOsK/w=="></script>



<script src="/nginx-ingress-controller/js/bootstrap.bundle.min.c15ed88f56a52190ea645094409cbce5537eaaf108972f777c840037b8aa0c508f12e70b09e345cf8af7e450a8f6ce96ae974340f8bcd316e58d707c063b6f72.js" type="text/javascript" integrity="sha512-wV7Yj1alIZDqZFCUQJy85VN&#43;qvEIly93fIQAN7iqDFCPEucLCeNFz4r35FCo9s6WrpdDQPi80xbljXB8Bjtvcg=="></script>



<script src="/nginx-ingress-controller/js/code-copy.b424b9cf3f8a69320d1a74e5b4345962141999ae58795c39fb9c5ac8953f3aef3373d7a334971f578e4dc4ee212cbe8f42951d16edb285e6a7931634998d900c.js" type="text/javascript" ></script>





<script class="coveo-script" src="https://static.cloud.coveo.com/searchui/v2.10104/0/js/CoveoJsSearch.Lazy.min.js" integrity="sha512-HxdDBIp5snbqtu1TPkBnXLKEvN9IPz3PeZW8zT9KfsflV9Ck822XDroDlpVbfCfXeiu8C0RDVn0fdu7aGy/H1g==" crossorigin="anonymous"></script>

<script src="https://static.cloud.coveo.com/searchui/v2.10104/0/js/templates/templates.js" integrity="sha512-CR0Yk/LIwgh1MsKqjecDp/r6F9ipKc6gA+4+E1pplT3N3r1pk+la/HaqyDiKtjOFwrwIIbIYBFrUJgPql93QHw==" crossorigin="anonymous"></script>






<script src="/nginx-ingress-controller/js/coveo.min.6e0e2c15ea8204cc128d34f0e7e13d16783166196b052d33cb05ec26a38415801ab03141a36256976745037faedb2da32dd8f3600b92b5f3c7d22fa634b0624f.js" integrity="sha512-bg4sFeqCBMwSjTTw5&#43;E9FngxZhlrBS0zywXsJqOEFYAasDFBo2JWl2dFA3&#43;u2y2jLdjzYAuStfPH0i&#43;mNLBiTw==" type="text/javascript"></script>






  
  

  
  





<script src="/nginx-ingress-controller/js/sidebar.min.89a78ac76492f78b44370cf6bbaa09457606d00a4b14db603de939e128451bf31bd29e46c179fbc3a1d632302f5ebfe61c5b9e65e2c171acd4981185cd3329b6.js" type="text/javascript" integrity="sha512-iaeKx2SS94tENwz2u6oJRXYG0ApLFNtgPek54ShFG/Mb0p5GwXn7w6HWMjAvXr/mHFueZeLBcazUmBGFzTMptg=="></script>
 
<div id="consent_blackbar" style="position:fixed;top:0px;width:100%"></div>
</body>
</html>


