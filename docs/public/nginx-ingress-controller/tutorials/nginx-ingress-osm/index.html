<!DOCTYPE html>
<html lang="en-us">

<head>  


<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>NGINX Ingress Controller and Open Service Mesh | NGINX Ingress Controller</title>






<link rel="canonical" href="https://docs.nginx.com/nginx-ingress-controller/tutorials/nginx-ingress-osm/">







<meta property="article:publisher" content="https://www.facebook.com/nginxinc" />
<meta property="og:image" content="https://docs.nginx.com/images/icons/NGINX-Docs-new-docs-dark-1200x630.png" />
<meta property="og:image:width" content="500" />
<meta property="og:image:height" content="300" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="" />
<meta name="twitter:title" content="NGINX Ingress Controller and Open Service Mesh" />
<meta name="twitter:site" content="@nginx" />
<meta name="twitter:image" content="https://docs.nginx.com/images/icons/NGINX-Docs-new-docs-dark-1200x630.png" />
<meta name="twitter:creator" content="@nginx" />




<meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline'
    https://consent.trustarc.com/ https://mktg.tags.f5.com/basic/prod/utag.sync.js https://static.cloud.coveo.com/ https://*.f5.com/
    https://*.netlify.app https://gist.github.com
    https://tag.demandbase.com/pscSDsz4.min.js
    https://munchkin.brightfunnel.com/js/build/bf-munchkin.min.js
    https://www.googletagmanager.com/gtm.js
    https://www.google-analytics.com/
    https://www.google-analytics.com/analytics.js
    https://www.google-analytics.com/plugins/ua/linkid.js
    https://cdn.bizible.com/scripts/bizible.js
    https://cdn.bizible.com/xdc.js
    https://f5networksglobalprod.122.2o7.net/
    https://f5networksnginxdocs.122.2o7.net/
    ;
    worker-src 'self' blob:">



<meta property="environment" type="production" />
<meta property="buildtype" type="webdocs" />
<meta property="isServer" type="false" />


<meta name="product" content="NGINX Ingress Controller">
<meta name="version" content="">
<meta name="doc_type" content="Manual">

<link rel="shortcut icon" type="image/x-icon" href="https://docs.nginx.com/images/favicon-48x48.ico">











<link href="/nginx-ingress-controller/fontawesome/css/all.min.4a71f958af9b67180f1ece38b96217f8b2c9009f7fd8f90f299e508808fa4daf3ac3e7ec6f64e47267d1c955f7a419cc15c57ba103c9925f507af4825abdd6e8.css" integrity="sha512-SnH5WK&#43;bZxgPHs44uWIX&#43;LLJAJ9/2PkPKZ5QiAj6Ta86w&#43;fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" rel="stylesheet" type="text/css">


<link href="/nginx-ingress-controller/fontawesome/css/v4-font-face.min.5870089ba06cf03e9721f87919eaf15c961a65e071845949ed2da58c5bfbd18a714c5dab2c155f0455ebcd2f45bfd598a5e47ae19976e7aa3a51e22914eac1b6.css" integrity="sha512-WHAIm6Bs8D6XIfh5GerxXJYaZeBxhFlJ7S2ljFv70YpxTF2rLBVfBFXrzS9Fv9WYpeR64Zl256o6UeIpFOrBtg==" rel="stylesheet" type="text/css">


<link href="/nginx-ingress-controller/fontawesome/css/v5-font-face.min.81bdf1c9f8ff16b1eda613d52d868a059f16c8c6045c3d7e0a0b771622a11666cdd94b8ea62b5edb0d4b826c3a3737ec3663065fe05b56b6b871e57de73f556b.css" integrity="sha512-gb3xyfj/FrHtphPVLYaKBZ8WyMYEXD1&#43;Cgt3FiKhFmbN2UuOpite2w1Lgmw6NzfsNmMGX&#43;BbVra4ceV95z9Vaw==" rel="stylesheet" type="text/css">

  

<link href="/nginx-ingress-controller/css/bootstrap.min.3f9320327d6304dd356ac060534cfad10938431897a3cebec2515a84aaec41fdfb73d72ba39d7b5b35523cf575b432b3864bb6889d855602faef01b4dd21a734.css" integrity="sha512-P5MgMn1jBN01asBgU0z60Qk4QxiXo86&#43;wlFahKrsQf37c9cro517WzVSPPV1tDKzhku2iJ2FVgL67wG03SGnNA==" rel="stylesheet" type="text/css">



<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.10104/0/css/CoveoFullSearch.min.css" integrity="sha512-9/A9yVCU4GS6/iIwTRJKnan4Hf8gDKj3anwItN9QCsU8SixaT5xkjjWsZ/iq0TWaizhtqOLacadXJfxHlwYCcA==" crossorigin="anonymous" />


<link href="/nginx-ingress-controller/css/docs-nginx-com/nginx-site-header.min.80b10ed49ecfad93607ee771acca88d13dc958e6eecc642af3aa2b170c86b8dcce442e7b86c3e5298c95b0ab2b053a71074c2f15c28266c3a2c502275415b3a7.css" rel="stylesheet" type="text/css">


<link href="/nginx-ingress-controller/css/docs-nginx-com/style.min.2cd4748c438c49d012a5fdc6b98770223c4875fe0f89517b17423b6a5328af4d93d9d772207bfc51d9449781281e1eb8707dcc2f7467e6e24330c9b8c7c5f734.css" rel="stylesheet" type="text/css">


<link href="/nginx-ingress-controller/css/bootstrap-docs.min.8a70c94c72e3783cecd631bc1705c7843b2fdef99f1549f0bf7f774a4083173ee25974413a8206c2340c0fee9bb7a07acd41d41c78ae2280c96a2ce0faca2847.css" rel="stylesheet" type="text/css">



<link href="/nginx-ingress-controller/css/coveo.min.fce7d4df31de99e4f86510a90915820f236b8dcd02be030b27529af7ff10189f807c78cedacb91afa9d07f310a172c6046b1921832f199b9158898a7f74fa117.css" rel="stylesheet" type="text/css">



<link href="/nginx-ingress-controller/css/f5-hugo.min.d668cd51e42f94f8d4fb9a81de0dcf6329a121173422b5695c37a707ac9df6ee4f90ee81b4dbecd797731a81f593ef80d85471bda37cb9af5ce617482982aa35.css" rel="stylesheet" type="text/css">





<link href="/nginx-ingress-controller/css/highlight.min.fe5647c4b67f4b3fcf0ea60b483479d567ba1b05ee6e816439207edfa3d310dbee79536278c67d89c1db5da275bde962a10163da375f05bd19743e2a80e1ad02.css" rel="stylesheet" type="text/css">







      
<script async="async" src="https://consent.trustarc.com/notice?domain=f5.com&c=teconsent&js=nj&noticeType=bb&text=true&gtm=1" crossorigin=""></script>



<script src="https://mktg.tags.f5.com/basic/prod/utag.sync.js"></script> 







<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-K5HG9JT');</script>

</head>

<body>
   
 
<script type="text/javascript"> 
    (function(a,b,c,d) { 
        a='//mktg.tags.f5.com/basic/prod/utag.js'; 
        b=document;c='script';d=b.createElement(c);d.src=a; 
        d.type='text/java'+c;d.async=true; 
        a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})(); 
</script> 
  

  <header>
    
<div class="navbar navbar-expand navbar-dark flex-column flex-md-row bd-navbar navbar-fixed-top">
  <div class="container-fluid flex-md-row flex-column">
    <a class="navbar-brand mr-0 mr-md-2" href="/" aria-label="NGINX Docs">
      <img class="navbar-img" src="https://docs.nginx.com/images/icons/NGINX-Docs-horiz-white-type.svg" alt="NGINX Docs">
    </a>
    
      <div class="navbar navbar-nav">
            
        <div id="searchbox">
          
          <div class="CoveoSearchbox" data-placeholder='Search NGINX Docs...'></div>
        </div>
      </div>
    
    

    <ul class="navbar navbar-nav">
        <li class="nav-item-explore active">
          <button class="button navbar-button"><a href="https://www.f5.com/products" alt="Explore all products on f5.com" target="_blank">Explore All Products</a></button>
        </li>
    </ul>
  </div>
</div>


  </header>

  
    
    <nav aria-label="breadcrumb" class="breadcrumb navbar">
    <div class="nav flex-md-row">
        <ol class="breadcrumb">
            <li><a href="/" alt="NGINX Docs Home">Home</a></li>

            
            
            
            
                
            
            
                
            
            
                
            
            
            
                <li><i class="fas fa-chevron-right"></i><a href="/nginx-ingress-controller/">NGINX Ingress Controller</a></a><i class="fas fa-chevron-right"></i></li>
                
            
                <li><a href="/nginx-ingress-controller/tutorials/">Tutorials</a><i class="fas fa-chevron-right"></i></li>
                
            
                NGINX Ingress Controller and Open Service Mesh
        </ol>
    </div>
</nav>

  
    
  

  <div class="main container-fluid min-page-height" data-menu-id="/nginx-ingress-controller/tutorials/nginx-ingress-osm/">
    
    
<div class="row" style="max-width: calc(100% + 30px) !important; flex-wrap: nowrap;">
  <nav class="sidenav overflow-auto col-md-3 d-none d-xl-block d-print-none align-top" style="width: 25%;">
    


<div id="sidebar-wrapper">

    <div id="sidebar" class="sidebar" aria-label="Sidebar navigation">
        <button id="sidebar-toggle-button" title="Toggle sidebar navigation" role="button" aria-controls="sidebar-content">
            <i class="fa fa-chevron-right sidebar-visible-collapsed"></i>
            <i class="fa fa-chevron-left sidebar-visible-expanded"></i>
        </button>
        <div id="sidebar-content">
            <h3>
                <a class="sidebar-title" href="https://docs.nginx.com/nginx-ingress-controller/" alt="NGINX Ingress Controller"><img
                        class="card-img-top" src="https://docs.nginx.com/images/icons/NGINX-Ingress-Controller-product-icon.svg"
                        alt="NGINX Ingress Controller">
                    NGINX Ingress Controller</a>
            </h3>
            <ul>
            
            
        
            
        
            
        
            
        
            
        
            
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                <a data-menu-id="/nginx-ingress-controller/overview/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#overview--overview"
                                    aria-controls="overview--overview">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Overview</a>
                            </li>
                        </div>
                        <div id="overview--overview" class="accordion-body collapse">
                            <div class="accordion-inner">
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/overview/about/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/overview/about/">About</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/overview/design/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/overview/design/">The design of NGINX Ingress Controller</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/overview/nginx-plus/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/overview/nginx-plus/">Extensibility with NGINX Plus</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/overview/product-telemetry/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/overview/product-telemetry/">Product telemetry</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            </div>
                        </div>
                    </div>
                </div>
                
            
                
                
                <ul class="sidebar-reg-padding">
                    <div class="accordion" id="accordion1">
                        <div class="accordion-group">
                            <div class="accordion-heading">
                                <ul>
                                    <li class="nginx-toc-link l1">
                                        <a data-menu-id="/nginx-ingress-controller/technical-specifications/"
                                            href="https://docs.nginx.com/nginx-ingress-controller/technical-specifications/">Technical specifications</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </ul>
                
                
            
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                <a data-menu-id="/nginx-ingress-controller/installation/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#installation--installation"
                                    aria-controls="installation--installation">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Installation</a>
                            </li>
                        </div>
                        <div id="installation--installation" class="accordion-body collapse">
                            <div class="accordion-inner">
                            
                            
                                
                                <div class="accordion" id="Accordion2">
                                    <div class="sidebar-l1-padding">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/installation/installing-nic/" class="accordion-toggle"
                                                            aria-expanded="false" data-toggle="collapse"
                                                            href="#installation--installation--install-nginx-ingress-controller">
                                                            <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                class="fa fa-2xs fa-fw fa-chevron-down"></i>Install NGINX Ingress Controller</a>
                                                    </li>
                                                <ul>
                                            </div>
                                            <div id="installation--installation--install-nginx-ingress-controller" class="accordion-body collapse leaf">
                                                <div class="accordion-inner">

                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/installing-nic/installation-with-helm/" href="https://docs.nginx.com/nginx-ingress-controller/installation/installing-nic/installation-with-helm/">Installation with Helm</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/installing-nic/installation-with-manifests/" href="https://docs.nginx.com/nginx-ingress-controller/installation/installing-nic/installation-with-manifests/">Installation with Manifests</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/installing-nic/installation-with-operator/" href="https://docs.nginx.com/nginx-ingress-controller/installation/installing-nic/installation-with-operator/">Installation with NGINX Ingress Operator</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/installation/build-nginx-ingress-controller/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/installation/build-nginx-ingress-controller/">Build NGINX Ingress Controller</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <div class="accordion" id="Accordion2">
                                    <div class="sidebar-l1-padding">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/installation/nic-images/" class="accordion-toggle"
                                                            aria-expanded="false" data-toggle="collapse"
                                                            href="#installation--installation--nginx-ingress-controller-images">
                                                            <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                class="fa fa-2xs fa-fw fa-chevron-down"></i>NGINX Ingress Controller images</a>
                                                    </li>
                                                <ul>
                                            </div>
                                            <div id="installation--installation--nginx-ingress-controller-images" class="accordion-body collapse leaf">
                                                <div class="accordion-inner">

                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/nic-images/get-registry-image/" href="https://docs.nginx.com/nginx-ingress-controller/installation/nic-images/get-registry-image/">Get NGINX Ingress Controller from the F5 Registry</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/nic-images/get-image-using-jwt/" href="https://docs.nginx.com/nginx-ingress-controller/installation/nic-images/get-image-using-jwt/">Get the NGINX Ingress Controller image with JWT</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/nic-images/use-aws-image/" href="https://docs.nginx.com/nginx-ingress-controller/installation/nic-images/use-aws-image/">Use the AWS Marketplace NGINX Ingress Controller image</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/nic-images/use-gcp-image/" href="https://docs.nginx.com/nginx-ingress-controller/installation/nic-images/use-gcp-image/">Use the GCP Marketplace NGINX Ingress Controller image</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/installation/run-multiple-ingress-controllers/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/installation/run-multiple-ingress-controllers/">Run multiple NGINX Ingress Controllers</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/installation/ingress-nginx/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/installation/ingress-nginx/">Migrate from Ingress-NGINX Controller to NGINX Ingress Controller</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <div class="accordion" id="Accordion2">
                                    <div class="sidebar-l1-padding">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/installation/integrations/" class="accordion-toggle"
                                                            aria-expanded="false" data-toggle="collapse"
                                                            href="#installation--installation--integrations">
                                                            <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                class="fa fa-2xs fa-fw fa-chevron-down"></i>Integrations</a>
                                                    </li>
                                                <ul>
                                            </div>
                                            <div id="installation--installation--integrations" class="accordion-body collapse leaf">
                                                <div class="accordion-inner">

                                                
                                                    
                                                    
                                                    <div class="accordion" id="Accordion3">
                                                        <div class="sidebar-l2-padding">
                                                            <div class="accordion-group sidebar-il-border">
                                                                <div class="accordion-heading">
                                                                    <ul>
                                                                        <li class="nginx-toc-link l2">
                                                                            <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-waf/" class="accordion-toggle"
                                                                                aria-expanded="false" data-toggle="collapse"
                                                                                href="#installation--integrations--nginx-app-protect-waf">
                                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>NGINX App Protect WAF</a>
                                                                        </li>
                                                                    <ul>
                                                                </div>
                                                                <div id="installation--integrations--nginx-app-protect-waf" class="accordion-body collapse leaf">
                                                                    <div class="accordion-inner">
                                                                    
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-waf/installation/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-waf/installation/">Build NGINX Ingress Controller with NGINX App Protect WAF</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-waf/configuration/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-waf/configuration/">Configuration</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-waf/compile-waf-policies/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-waf/compile-waf-policies/">Compile NGINX App Protect WAF policies using NGINX Instance Manager</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-waf/troubleshoot-app-protect-waf/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-waf/troubleshoot-app-protect-waf/">Troubleshoot NGINX App Protect WAF</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                
                                                    
                                                    
                                                    <div class="accordion" id="Accordion3">
                                                        <div class="sidebar-l2-padding">
                                                            <div class="accordion-group sidebar-il-border">
                                                                <div class="accordion-heading">
                                                                    <ul>
                                                                        <li class="nginx-toc-link l2">
                                                                            <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-waf-v5/" class="accordion-toggle"
                                                                                aria-expanded="false" data-toggle="collapse"
                                                                                href="#installation--integrations--nginx-app-protect-waf-v5">
                                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>NGINX App Protect WAF v5</a>
                                                                        </li>
                                                                    <ul>
                                                                </div>
                                                                <div id="installation--integrations--nginx-app-protect-waf-v5" class="accordion-body collapse leaf">
                                                                    <div class="accordion-inner">
                                                                    
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-waf-v5/installation/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-waf-v5/installation/">Build NGINX Ingress Controller with NGINX App Protect WAF v5</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-waf-v5/configuration/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-waf-v5/configuration/">Configuration</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                
                                                    
                                                    
                                                    <div class="accordion" id="Accordion3">
                                                        <div class="sidebar-l2-padding">
                                                            <div class="accordion-group sidebar-il-border">
                                                                <div class="accordion-heading">
                                                                    <ul>
                                                                        <li class="nginx-toc-link l2">
                                                                            <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-dos/" class="accordion-toggle"
                                                                                aria-expanded="false" data-toggle="collapse"
                                                                                href="#installation--integrations--nginx-app-protect-dos">
                                                                                <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                                    class="fa fa-2xs fa-fw fa-chevron-down"></i>NGINX App Protect DoS</a>
                                                                        </li>
                                                                    <ul>
                                                                </div>
                                                                <div id="installation--integrations--nginx-app-protect-dos" class="accordion-body collapse leaf">
                                                                    <div class="accordion-inner">
                                                                    
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-dos/installation/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-dos/installation/">Build NGINX Ingress Controller with NGINX App Protect DoS</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-dos/configuration/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-dos/configuration/">Configuration</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-dos/dos-protected/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-dos/dos-protected/">DoS protected resource specification</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    
                                                                    
                                                                        <ul class="sidebar-l2-padding">
                                                                            <li class="nginx-toc-link l3 sidebar-il-border ">
                                                                                <a data-menu-id="/nginx-ingress-controller/installation/integrations/app-protect-dos/troubleshoot-app-protect-dos/"
                                                                                    href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/app-protect-dos/troubleshoot-app-protect-dos/">Troubleshoot NGINX App Protect DoS</a>
                                                                            </li>
                                                                        </ul>
                                                                    
                                                                    
                                                                        
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/integrations/f5-ingresslink/" href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/f5-ingresslink/">F5 BIG-IP</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/installation/integrations/opentracing/" href="https://docs.nginx.com/nginx-ingress-controller/installation/integrations/opentracing/">OpenTracing</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                            
                            </div>
                        </div>
                    </div>
                </div>
                
            
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                <a data-menu-id="/nginx-ingress-controller/configuration/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#configuration--configuration"
                                    aria-controls="configuration--configuration">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Configuration</a>
                            </li>
                        </div>
                        <div id="configuration--configuration" class="accordion-body collapse">
                            <div class="accordion-inner">
                            
                            
                                
                                <div class="accordion" id="Accordion2">
                                    <div class="sidebar-l1-padding">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/configuration/global-configuration/" class="accordion-toggle"
                                                            aria-expanded="false" data-toggle="collapse"
                                                            href="#configuration--configuration--global-configuration">
                                                            <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                class="fa fa-2xs fa-fw fa-chevron-down"></i>Global configuration</a>
                                                    </li>
                                                <ul>
                                            </div>
                                            <div id="configuration--configuration--global-configuration" class="accordion-body collapse leaf">
                                                <div class="accordion-inner">

                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/global-configuration/command-line-arguments/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/global-configuration/command-line-arguments/">Command-line arguments</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/global-configuration/globalconfiguration-resource/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/global-configuration/globalconfiguration-resource/">GlobalConfiguration resource</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/global-configuration/configmap-resource/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/global-configuration/configmap-resource/">ConfigMap resources</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/global-configuration/custom-templates/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/global-configuration/custom-templates/">Custom templates</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/global-configuration/reporting-resources-status/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/global-configuration/reporting-resources-status/">Reporting resource status</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                            
                            
                                
                                <div class="accordion" id="Accordion2">
                                    <div class="sidebar-l1-padding">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/configuration/ingress-resources/" class="accordion-toggle"
                                                            aria-expanded="false" data-toggle="collapse"
                                                            href="#configuration--configuration--ingress-resources">
                                                            <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                                                class="fa fa-2xs fa-fw fa-chevron-down"></i>Ingress resources</a>
                                                    </li>
                                                <ul>
                                            </div>
                                            <div id="configuration--configuration--ingress-resources" class="accordion-body collapse leaf">
                                                <div class="accordion-inner">

                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/ingress-resources/basic-configuration/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/basic-configuration/">Basic configuration</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/ingress-resources/advanced-configuration-with-annotations/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/advanced-configuration-with-annotations/">Advanced configuration with Annotations</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/ingress-resources/custom-annotations/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/custom-annotations/">Custom annotations</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/ingress-resources/advanced-configuration-with-snippets/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/advanced-configuration-with-snippets/">Advanced configuration with Snippets</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                    
                                                    
                                                    <ul class="sidebar-l2-padding">
                                                        <li class="nginx-toc-link l3 sidebar-il-border">
                                                            <a data-menu-id="/nginx-ingress-controller/configuration/ingress-resources/cross-namespace-configuration/" href="https://docs.nginx.com/nginx-ingress-controller/configuration/ingress-resources/cross-namespace-configuration/">Cross-namespace configuration</a>
                                                        </li>
                                                    </ul>
                                                    
                                                    
                                                
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/configuration/security/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/configuration/security/">Security recommendations</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/configuration/configuration-examples/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/configuration/configuration-examples/">Configuration examples</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/configuration/policy-resource/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/configuration/policy-resource/">Policy resources</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/configuration/transportserver-resource/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/configuration/transportserver-resource/">TransportServer resources</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/configuration/virtualserver-and-virtualserverroute-resources/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/configuration/virtualserver-and-virtualserverroute-resources/">VirtualServer and VirtualServerRoute resources</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/configuration/host-and-listener-collisions/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/configuration/host-and-listener-collisions/">Host and Listener collisions</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            </div>
                        </div>
                    </div>
                </div>
                
            
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                <a data-menu-id="/nginx-ingress-controller/logging-and-monitoring/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#logging-and-monitoring--logging-and-monitoring"
                                    aria-controls="logging-and-monitoring--logging-and-monitoring">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Logging And Monitoring</a>
                            </li>
                        </div>
                        <div id="logging-and-monitoring--logging-and-monitoring" class="accordion-body collapse">
                            <div class="accordion-inner">
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/logging-and-monitoring/logging/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/logging-and-monitoring/logging/">Logging</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/logging-and-monitoring/status-page/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/logging-and-monitoring/status-page/">Status Page</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/logging-and-monitoring/prometheus/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/logging-and-monitoring/prometheus/">Prometheus</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/logging-and-monitoring/service-insight/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/logging-and-monitoring/service-insight/">Service Insight</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            </div>
                        </div>
                    </div>
                </div>
                
            
                
                
                <ul class="sidebar-reg-padding">
                    <div class="accordion" id="accordion1">
                        <div class="accordion-group">
                            <div class="accordion-heading">
                                <ul>
                                    <li class="nginx-toc-link l1">
                                        <a data-menu-id="/nginx-ingress-controller/usage-reporting/"
                                            href="https://docs.nginx.com/nginx-ingress-controller/usage-reporting/">Enable Usage Reporting</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </ul>
                
                
            
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                <a data-menu-id="/nginx-ingress-controller/troubleshooting/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#troubleshooting--troubleshooting"
                                    aria-controls="troubleshooting--troubleshooting">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Troubleshooting</a>
                            </li>
                        </div>
                        <div id="troubleshooting--troubleshooting" class="accordion-body collapse">
                            <div class="accordion-inner">
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/troubleshooting/troubleshoot-common/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/troubleshooting/troubleshoot-common/">Troubleshooting common issues</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/troubleshooting/troubleshoot-configmap-policy/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/troubleshooting/troubleshoot-configmap-policy/">Troubleshooting Policy resources</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/troubleshooting/troubleshoot-ingress/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/troubleshooting/troubleshoot-ingress/">Troubleshooting Ingress resources</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/troubleshooting/troubleshoot-virtualserver/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/troubleshooting/troubleshoot-virtualserver/">Troubleshooting VirtualServer resources</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            </div>
                        </div>
                    </div>
                </div>
                
            
                
                <div class="accordion" id="accordion1">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <li class="nginx-toc-link l1">
                                <a data-menu-id="/nginx-ingress-controller/tutorials/" class="accordion-toggle" aria-expanded="false"
                                    data-toggle="collapse" href="#" data-target="#tutorials--tutorials"
                                    aria-controls="tutorials--tutorials">
                                    <i class="fa fa-2xs fa-fw fa-chevron-right"></i><i
                                        class="fa fa-2xs fa-fw fa-chevron-down"></i>Tutorials</a>
                            </li>
                        </div>
                        <div id="tutorials--tutorials" class="accordion-body collapse">
                            <div class="accordion-inner">
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/virtual-server-with-custom-listener-ports/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/virtual-server-with-custom-listener-ports/">Configuring VirtualServer with custom HTTP and HTTPS listener ports</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/security-monitoring/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/security-monitoring/">Connect NGINX App Protect WAF to NGINX Security Monitoring</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/oidc-custom-configuration/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/oidc-custom-configuration/">Customize OIDC Configuration with NGINX Ingress Controller</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/custom-listen-ports/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/custom-listen-ports/">Customizing NGINX Ingress Controller Ports</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/ingress-path-regex-annotation/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/ingress-path-regex-annotation/">Ingresses Path Matching Using Path-Regex Annotation</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/nginx-ingress-istio/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/nginx-ingress-istio/">NGINX Ingress Controller and Istio Service Mesh</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/nginx-ingress-linkerd/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/nginx-ingress-linkerd/">NGINX Ingress Controller and Linkerd</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/nginx-ingress-osm/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/nginx-ingress-osm/">NGINX Ingress Controller and Open Service Mesh</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            
                                
                                <ul class="sidebar-reg-padding">
                                    <div class="accordion" id="accordion2">
                                        <div class="accordion-group sidebar-il-border">
                                            <div class="accordion-heading">
                                                <ul>
                                                    <li class="nginx-toc-link l2">
                                                        <a data-menu-id="/nginx-ingress-controller/tutorials/nginx-dynamic-module/"
                                                            href="https://docs.nginx.com/nginx-ingress-controller/tutorials/nginx-dynamic-module/">Using NGINX Ingress Controller with NGINX Dynamic Modules</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                
                                
                            
                            </div>
                        </div>
                    </div>
                </div>
                
            
                
                
                <ul class="sidebar-reg-padding">
                    <div class="accordion" id="accordion1">
                        <div class="accordion-group">
                            <div class="accordion-heading">
                                <ul>
                                    <li class="nginx-toc-link l1">
                                        <a data-menu-id="/nginx-ingress-controller/releases/"
                                            href="https://docs.nginx.com/nginx-ingress-controller/releases/">Releases</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </ul>
                
                
            
                
                
                <ul class="sidebar-reg-padding">
                    <div class="accordion" id="accordion1">
                        <div class="accordion-group">
                            <div class="accordion-heading">
                                <ul>
                                    <li class="nginx-toc-link l1">
                                        <a data-menu-id="/nginx-ingress-controller/community/"
                                            href="https://docs.nginx.com/nginx-ingress-controller/community/">Community and contributing</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </ul>
                
                
            
                
                
                <ul class="sidebar-reg-padding">
                    <div class="accordion" id="accordion1">
                        <div class="accordion-group">
                            <div class="accordion-heading">
                                <ul>
                                    <li class="nginx-toc-link l1">
                                        <a data-menu-id="/nginx-ingress-controller/glossary/"
                                            href="https://docs.nginx.com/nginx-ingress-controller/glossary/">Glossary</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </ul>
                
                
            
        

            </ul>
        </div>
    
    </div>

</div>


  </nav>
  
  
  <main class="content col d-block align-top content-has-toc" role="main">
  
    
    <h1>NGINX Ingress Controller and Open Service Mesh</h1>

      

      
  
    <p>This document outlines how to integrate F5 NGINX Ingress Controller with Open Service Mesh (OSM)</p>
<p>Open Service Mesh will work with both versions of <a href="https://github.com/nginxinc/kubernetes-ingress" target="_blank" rel="noopener">F5 NGINX Ingress controller</a>: the free as well as the NGINX Plus versions.</p>
<p>Below is a link to the official F5 NGINX Ingress Controller documentation.
<a href="https://docs.nginx.com/nginx-ingress-controller/" target="_blank" rel="noopener">F5 NGINX Ingress controller</a></p>
<h1 
id="integrating-nginx-ingress-controller-with-open-service-mesh">Integrating NGINX Ingress Controller with Open Service Mesh  <a class="headerlink float-right" href="#integrating-nginx-ingress-controller-with-open-service-mesh" title="Integrating NGINX Ingress Controller with Open Service Mesh"><i class="fas fa-link fa-xs"></i></a>
</h1><p>There are two ways to integrate NGINX Ingress Controller with Open Service Mesh (OSM):</p>
<ol>
<li>Injecting an envoy sidecar directly with NGINX Ingress Controller.</li>
<li>Using the Open Service Mesh <code>ingressBackend</code> &ldquo;proxy&rdquo; feature.</li>
</ol>
<h1 
id="nginx-ingress-controller-and-osm-with-sidecar-proxy-injected">NGINX Ingress controller and OSM with sidecar proxy injected  <a class="headerlink float-right" href="#nginx-ingress-controller-and-osm-with-sidecar-proxy-injected" title="NGINX Ingress controller and OSM with sidecar proxy injected"><i class="fas fa-link fa-xs"></i></a>
</h1><p>Install OSM in the cluster</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">osm install --mesh-name osm-nginx --osm-namespace osm-system
</span></span></code></pre></div><h3 
id="mark-the-f5-nginx-ingress-controller-namespace-for-sidecar-injection">Mark the F5 NGINX Ingress controller namespace for sidecar injection  <a class="headerlink float-right" href="#mark-the-f5-nginx-ingress-controller-namespace-for-sidecar-injection" title="Mark the F5 NGINX Ingress controller namespace for sidecar injection"><i class="fas fa-link fa-xs"></i></a>
</h3><p><em>NOTE:</em> Depending on how you install NGINX Ingress controller, you might need to create the <code>namespace</code>. For example, if you are using manifests to install NGINX Ingress controller, you can complete all of the steps on our documentation page, <em>EXCEPT</em>, actually deploying NGINX Ingress controller. This is because, when using the sidecar approach, OSM needs to &ldquo;manage&rdquo; the namespace so it knows what <code>namespaces</code> it needs to inject sidecars into.</p>
<p>Next thing we need to do is install OSM into the <code>NGINX Ingress controller</code> namespace so that the <code>envoy</code> sidecar will be injected into NGINX Ingress controller.
First, create the <code>nginx-ingress</code> namespace:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl create ns nginx-ingress
</span></span></code></pre></div><p>Then &ldquo;mark&rdquo; the <code>nginx-ingress</code> namespace for OSM to deploy a sidecar.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">osm namespace add nginx-ingress --mesh-name osm-nginx
</span></span></code></pre></div><p>The above command will use the mark the <code>nginx-ingress</code> namespace, where OSM will be installed (sidecar)</p>
<h1 
id="install-f5-nginx-ingress-controller">Install F5 NGINX Ingress controller  <a class="headerlink float-right" href="#install-f5-nginx-ingress-controller" title="Install F5 NGINX Ingress controller"><i class="fas fa-link fa-xs"></i></a>
</h1><p>Links to the complete install guides:</p>
<p><a href="https://docs.nginx.com/nginx-ingress-controller/installation/installation-with-helm/" target="_blank" rel="noopener">Using Helm to install NGINX Ingress</a>
<a href="https://docs.nginx.com/nginx-ingress-controller/installation/installation-with-manifests/" target="_blank" rel="noopener">Using Manifests to install NGINX Ingress</a></p>
<p>When using the sidecar method, ensure that you add the correct annotations listed below. This ensures proper integration of NGINX Ingress Controller with the envoy sidecar proxy.</p>
<h2 
id="helm-installs">Helm installs  <a class="headerlink float-right" href="#helm-installs" title="Helm installs"><i class="fas fa-link fa-xs"></i></a>
</h2><p>If using <code>helm</code>, add the following <code>annotation</code> to your <code>values.yaml</code> file:</p>
<p>Under <code>controller.pod.annotations</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">pod</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span><span class="w"> </span>{<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">openservicemesh.io/inbound-port-exclusion-list</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;80, 443&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>}<span class="w">
</span></span></span></code></pre></div><p>You can also use the <code>set</code> command available with <code>helm</code> to set these at install time.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">helm install nic01 nginx-stable/nginx-ingress -n nginx-ingress --create-namespace --set controller.pod.annotations.<span class="s1">&#39;openservicemesh\.io/inbound\-port\-exclusion\-list=\{ &#34;80&#34;\, &#34;443&#34;\ }&#39;</span>
</span></span></code></pre></div><p>Change your <code>release</code> accordingly to match your environment.</p>
<h2 
id="manifest-installs">Manifest installs  <a class="headerlink float-right" href="#manifest-installs" title="Manifest installs"><i class="fas fa-link fa-xs"></i></a>
</h2><p>For your <code>manifest</code> deployments, add the following <code>annotation</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">openservicemesh.io/inbound-port-exclusion-list</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;80,443&#34;</span><span class="w">
</span></span></span></code></pre></div><h3 
id="sample-deployment-file-with-required-annotation">Sample deployment file with required annotation  <a class="headerlink float-right" href="#sample-deployment-file-with-required-annotation" title="Sample deployment file with required annotation"><i class="fas fa-link fa-xs"></i></a>
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">apps/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Deployment</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">nginx-ingress</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">nginx-ingress</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">selector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">nginx-ingress</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l">nginx-ingress</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">openservicemesh.io/inbound-port-exclusion-list</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;80,443&#34;</span><span class="w">
</span></span></span></code></pre></div><p>This annotation is <em>required</em> when injecting envoy sidecar into NGINX Ingress controller.
<code>InboundPortExclusionList</code> defines a global list of ports to exclude from inbound traffic interception by the sidecar proxy.</p>
<h3 
id="install-a-test-application">Install a Test Application  <a class="headerlink float-right" href="#install-a-test-application" title="Install a Test Application"><i class="fas fa-link fa-xs"></i></a>
</h3><p>To test the integration, we will use the <code>httpbin</code> sample application from the <a href="https://release-v1-2.docs.openservicemesh.io/docs/demos/ingress_k8s_nginx/" target="_blank" rel="noopener">Ingress With Kubernetes NGINX Ingress Controller</a> guide.</p>
<p>The following three commands will create the namespace for the application, add the namespace to OSM for monitoring, then install the application.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl create ns httpbin
</span></span><span class="line"><span class="cl">osm namespace add httpbin --mesh-name osm-nginx
</span></span><span class="line"><span class="cl">kubectl apply -f https://raw.githubusercontent.com/openservicemesh/osm-docs/release-v1.2/manifests/samples/httpbin/httpbin.yaml -n httpbin
</span></span></code></pre></div><h3 
id="verify-that-the-envoy-sidecar-has-been-injected-into-nginx-ingress-controller">Verify that the envoy sidecar has been <em>injected</em> into NGINX Ingress Controller  <a class="headerlink float-right" href="#verify-that-the-envoy-sidecar-has-been-injected-into-nginx-ingress-controller" title="Verify that the envoy sidecar has been injected into NGINX Ingress Controller"><i class="fas fa-link fa-xs"></i></a>
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl get pods -n nginx-ingress
</span></span><span class="line"><span class="cl">NAME                             READY   STATUS    RESTARTS       AGE
</span></span><span class="line"><span class="cl">nginx-ingress-7b9557ddc6-zw7l5   2/2     Running   <span class="m">1</span> <span class="o">(</span>5m8s ago<span class="o">)</span>   5m19s
</span></span></code></pre></div><p>2/2 shows we have two containers in the NGINX Ingress controller pod: NGINX Ingress and Envoy</p>
<p>Configure your NGINX VirtualServer yaml to similar below</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">k8s.nginx.org/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">VirtualServer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">secret</span><span class="p">:</span><span class="w"> </span><span class="l">secret01</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">upstreams</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">14001</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">use-cluster-ip</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">routes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">proxy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">upstream</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">requestHeaders</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">set</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Host</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin.httpbin.svc.cluster.local</span><span class="w">
</span></span></span></code></pre></div><p>Test your configuration:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> curl  http://httpbin.example.com/get -v
</span></span><span class="line"><span class="cl">*   Trying 172.19.0.2:80...
</span></span><span class="line"><span class="cl">* TCP_NODELAY <span class="nb">set</span>
</span></span><span class="line"><span class="cl">* Connected to httpbin.example.com <span class="o">(</span>172.19.0.2<span class="o">)</span> port <span class="m">80</span> <span class="o">(</span><span class="c1">#0)</span>
</span></span><span class="line"><span class="cl">&gt; GET /get HTTP/1.1
</span></span><span class="line"><span class="cl">&gt; Host: httpbin.example.com
</span></span><span class="line"><span class="cl">&gt; User-Agent: curl/7.68.0
</span></span><span class="line"><span class="cl">&gt; Accept: */*
</span></span><span class="line"><span class="cl">&gt;
</span></span><span class="line"><span class="cl">* Mark bundle as not supporting multiuse
</span></span><span class="line"><span class="cl">&lt; HTTP/1.1 <span class="m">200</span> OK
</span></span><span class="line"><span class="cl">&lt; Server: nginx/1.23.3
</span></span><span class="line"><span class="cl">&lt; Date: Sun, <span class="m">19</span> Feb <span class="m">2023</span> 19:06:47 GMT
</span></span><span class="line"><span class="cl">&lt; Content-Type: application/json
</span></span><span class="line"><span class="cl">&lt; Content-Length: <span class="m">454</span>
</span></span><span class="line"><span class="cl">&lt; Connection: keep-alive
</span></span><span class="line"><span class="cl">&lt; access-control-allow-origin: *
</span></span><span class="line"><span class="cl">&lt; access-control-allow-credentials: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">&lt; x-envoy-upstream-service-time: <span class="m">2</span>
</span></span><span class="line"><span class="cl">&lt;
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;args&#34;</span>: <span class="o">{}</span>,
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;headers&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Accept&#34;</span>: <span class="s2">&#34;*/*&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Host&#34;</span>: <span class="s2">&#34;httpbin.httpbin.svc.cluster.local&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Osm-Stats-Kind&#34;</span>: <span class="s2">&#34;Deployment&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Osm-Stats-Name&#34;</span>: <span class="s2">&#34;httpbin&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Osm-Stats-Namespace&#34;</span>: <span class="s2">&#34;httpbin&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Osm-Stats-Pod&#34;</span>: <span class="s2">&#34;httpbin-78555f5c4b-t6qln&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;User-Agent&#34;</span>: <span class="s2">&#34;curl/7.68.0&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;X-Envoy-Internal&#34;</span>: <span class="s2">&#34;true&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;X-Forwarded-Host&#34;</span>: <span class="s2">&#34;httpbin.example.com&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>,
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;origin&#34;</span>: <span class="s2">&#34;172.19.0.1&#34;</span>,
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;url&#34;</span>: <span class="s2">&#34;http://httpbin.example.com/get&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">* Connection <span class="c1">#0 to host httpbin.example.com left intact</span>
</span></span></code></pre></div><h2 
id="using-the-open-service-mesh-ingressbackend-proxy-feature">Using The Open Service Mesh <code>ingressBackend</code> &ldquo;proxy&rdquo; Feature  <a class="headerlink float-right" href="#using-the-open-service-mesh-ingressbackend-proxy-feature" title="Using The Open Service Mesh ingressBackend &ldquo;proxy&rdquo; Feature"><i class="fas fa-link fa-xs"></i></a>
</h2><p>Install OSM into the cluster.
By running the following command, you will install OSM into the cluster with the mesh name <code>osm-nginx</code> using the <code>osm-system</code> namespace.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">osm install --mesh-name osm-nginx --osm-namespace osm-system
</span></span></code></pre></div><p>Once OSM has been installed, this next command will mark NGINX Ingress Controller as part of the OSM mesh, while also disabling sidecar injection.
<em>NOTE</em>: The nginx-ingress name can be created as part of the NGINX Ingress install process, or manually. If you are creating it manually, the namespace must created before you &ldquo;add&rdquo; the namespace to Open Service Mesh.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">osm namespace add nginx-ingress --mesh-name osm-nginx --disable-sidecar-injection
</span></span></code></pre></div><h1 
id="install-f5-nginx-ingress-controller-1">Install F5 NGINX Ingress controller  <a class="headerlink float-right" href="#install-f5-nginx-ingress-controller-1" title="Install F5 NGINX Ingress controller"><i class="fas fa-link fa-xs"></i></a>
</h1><p>Links to the complete install guides:</p>
<p><a href="https://docs.nginx.com/nginx-ingress-controller/installation/installation-with-helm/" target="_blank" rel="noopener">Using Helm to install NGINX Ingress</a>
<a href="https://docs.nginx.com/nginx-ingress-controller/installation/installation-with-manifests/" target="_blank" rel="noopener">Using Manifests to install NGINX Ingress</a></p>
<p><em>NOTE</em>: This method does NOT require annotations added to the deployment, compared to the sidecar install method.</p>
<h3 
id="install-a-test-application-1">Install a Test Application  <a class="headerlink float-right" href="#install-a-test-application-1" title="Install a Test Application"><i class="fas fa-link fa-xs"></i></a>
</h3><p>To test the integration, we will use the <code>httpbin</code> sample application from the <a href="https://release-v1-2.docs.openservicemesh.io/docs/demos/ingress_k8s_nginx/" target="_blank" rel="noopener">Ingress With Kubernetes NGINX Ingress Controller</a> guide.</p>
<p>The following three commands will create the namespace for the application, add the namespace to OSM for monitoring, then install the application.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl create ns httpbin
</span></span><span class="line"><span class="cl">osm namespace add httpbin --mesh-name osm-nginx
</span></span><span class="line"><span class="cl">kubectl apply -f https://raw.githubusercontent.com/openservicemesh/osm-docs/release-v1.2/manifests/samples/httpbin/httpbin.yaml -n httpbin
</span></span></code></pre></div><h3 
id="mtls-setup">mTLS Setup  <a class="headerlink float-right" href="#mtls-setup" title="mTLS Setup"><i class="fas fa-link fa-xs"></i></a>
</h3><p>To enable mTLS for NGINX Ingress Controller and OSM, you need to configure the <code>IngressBackend</code> API to use <code>https</code> as the backend protocol as and trigger OSM to issue a certificate. NGINX will use this certificate to proxy HTTPS connections to the TLS backends. The client certificate and certificate authority (CA) certificate will be stored in a Kubernetes secret that NGINX will use for authentication.&quot;</p>
<p>To begin, edit the <code>osm-mesh-config</code> resource:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl edit meshconfig osm-mesh-config -n osm-system
</span></span></code></pre></div><p>You will need to update under <code>certificate</code> to look like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">certificate</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ingressGateway</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">secret</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">osm-nginx-client-cert</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">osm-system</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">subjectAltNames</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">nginx-ingress.nginx-ingress.cluster.local</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">validityDuration</span><span class="p">:</span><span class="w"> </span><span class="l">24h</span><span class="w">
</span></span></span></code></pre></div><p>This will generate a new client certificate (osm-nginx-client-cert) that NGINX Ingress controller will use for mTLS.
The <em>SAN</em>, <code>subjectAltNames</code>, is the following form:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&lt;service_account&gt;.&lt;namespace&gt;.cluster.local
</span></span></code></pre></div><p>With the above OSM mesh config changed, that secret will be created in the <code>osm-system</code> namespace.
There will also be the <code>osm-ca-bundle</code> secret as well, which is autogenerated by OSM.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl get secrets -n osm-system
</span></span><span class="line"><span class="cl">NAME                              TYPE                 DATA   AGE
</span></span><span class="line"><span class="cl">osm-ca-bundle                     Opaque               <span class="m">2</span>      37m
</span></span><span class="line"><span class="cl">osm-nginx-client-cert             kubernetes.io/tls    <span class="m">3</span>      17m
</span></span></code></pre></div><p>Now, we need to &ldquo;export&rdquo; out these certificates in order to use them with NGINX Ingress Controller.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl get secret osm-ca-bundle -n osm-system -o yaml &gt; osm-ca-bundle-secret.yaml
</span></span><span class="line"><span class="cl">kubectl get secret osm-nginx-client-cert -n osm-system -o yaml &gt; osm-nginx-client-cert.yaml
</span></span></code></pre></div><p>We need to edit the two exported out .yaml files and change a few parts.</p>
<p>Edit <code>osm-ca-bundle-secret.yaml</code>
Remove the <code>private.key</code> section under <code>data.</code>
Change the <code>namespace</code> field to your nginx-ingress location
Change the <code>type</code> to <code>type: nginx.org/ca</code></p>
<p>Updated file should look like the following.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Secret</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">osm-ca-bundle</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">nginx-ingress</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">nginx.org/ca</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">data</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">ca.crt</span><span class="p">:</span><span class="w"> </span><span class="l">&lt;ca_cert_data&gt;</span><span class="w">
</span></span></span></code></pre></div><p>Edit <code>osm-nginx-client-cert.yaml</code>
Remove the <code>ca.crt</code> in the <code>data</code> section
Change the namespace to the nginx-ingress namespace.</p>
<p>Updated file should look like the following.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Secret</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">osm-nginx-client-cert</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">nginx-ingress</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">kubernetes.io/tls</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">data</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tls.crt</span><span class="p">:</span><span class="w"> </span><span class="l">&lt;tls_crt_data&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tls.key</span><span class="p">:</span><span class="w"> </span><span class="l">&lt;tls_key_data&gt;</span><span class="w">
</span></span></span></code></pre></div><p>Then apply these two secrets to the cluster.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl apply -f osm-ca-bundle-secret.yaml
</span></span><span class="line"><span class="cl">kubectl apply -f osm-nginx-client-cert.yaml
</span></span></code></pre></div><p>Ensure the secrets exist in the <code>nginx-ingress</code> namespace:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl get secrets -n nginx-ingress
</span></span><span class="line"><span class="cl">NAME                    TYPE                DATA   AGE
</span></span><span class="line"><span class="cl">osm-nginx-client-cert   kubernetes.io/tls   <span class="m">2</span>      23m
</span></span><span class="line"><span class="cl">osm-ca-bundle           nginx.org/ca        <span class="m">1</span>      23m
</span></span></code></pre></div><p>We now need to create our CRDs (virtualServer and policy).
Here is the <code>policy</code> resource that holds the mTLS information.
Make sure you apply the <code>policy</code> or the  mTLS connection will not work. (required for virtualServer)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">k8s.nginx.org/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Policy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">osm-mtls</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">nginx-ingress</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">egressMTLS</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">tlsSecret</span><span class="p">:</span><span class="w"> </span><span class="l">osm-nginx-client-cert</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">trustedCertSecret</span><span class="p">:</span><span class="w"> </span><span class="l">osm-ca-bundle</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">verifyDepth</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">verifyServer</span><span class="p">:</span><span class="w"> </span><span class="kc">on</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">sslName</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin.httpbin.cluster.local</span><span class="w">
</span></span></span></code></pre></div><p>Here is an example <code>virtualServer</code> resource as well as the <code>ingressBackend</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">k8s.nginx.org/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">VirtualServer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">policies</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">osm-mtls</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">nginx-ingress</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin.example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">secret</span><span class="p">:</span><span class="w"> </span><span class="l">secret01</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">upstreams</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">14001</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">tls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">enable</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">routes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">action</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">pass</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">---</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">IngressBackend</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">policy.openservicemesh.io/v1alpha1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">backends</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">httpbin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="m">14001</span><span class="w"> </span><span class="c"># targetPort of httpbin service</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l">https</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">tls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">skipClientCertValidation</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">sources</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Service</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">nginx-ingress</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">nginx-ingress</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">AuthenticatedPrincipal</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">nginx-ingress.nginx-ingress.cluster.local</span><span class="w">
</span></span></span></code></pre></div><p>Once these are applied, verify they are valid (virtualServer) and committed (ingressBackend):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kubectl get vs,ingressbackend -A
</span></span><span class="line"><span class="cl">NAMESPACE   NAME                                  STATE   HOST                  IP    PORTS   AGE
</span></span><span class="line"><span class="cl">httpbin     virtualserver.k8s.nginx.org/httpbin   Valid   httpbin.example.com                 26m
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NAMESPACE   NAME                                               STATUS
</span></span><span class="line"><span class="cl">httpbin     ingressbackend.policy.openservicemesh.io/httpbin   committed
</span></span></code></pre></div><p>You can now send traffic through NGINX Ingress Controller with open service mesh.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">curl http://httpbin.example.com/get -v
</span></span><span class="line"><span class="cl">*   Trying 172.18.0.2:80...
</span></span><span class="line"><span class="cl">* TCP_NODELAY <span class="nb">set</span>
</span></span><span class="line"><span class="cl">* Connected to httpbin.example.com <span class="o">(</span>172.18.0.2<span class="o">)</span> port <span class="m">80</span> <span class="o">(</span><span class="c1">#0)</span>
</span></span><span class="line"><span class="cl">&gt; GET /get HTTP/1.1
</span></span><span class="line"><span class="cl">&gt; Host: httpbin.example.com
</span></span><span class="line"><span class="cl">&gt; User-Agent: curl/7.68.0
</span></span><span class="line"><span class="cl">&gt; Accept: */*
</span></span><span class="line"><span class="cl">&gt;
</span></span><span class="line"><span class="cl">* Mark bundle as not supporting multiuse
</span></span><span class="line"><span class="cl">&lt; HTTP/1.1 <span class="m">200</span> OK
</span></span><span class="line"><span class="cl">&lt; Server: nginx/1.23.3
</span></span><span class="line"><span class="cl">&lt; Date: Sat, <span class="m">18</span> Feb <span class="m">2023</span> 22:41:27 GMT
</span></span><span class="line"><span class="cl">&lt; Content-Type: application/json
</span></span><span class="line"><span class="cl">&lt; Content-Length: <span class="m">280</span>
</span></span><span class="line"><span class="cl">&lt; Connection: keep-alive
</span></span><span class="line"><span class="cl">&lt; access-control-allow-origin: *
</span></span><span class="line"><span class="cl">&lt; access-control-allow-credentials: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">&lt; x-envoy-upstream-service-time: <span class="m">1</span>
</span></span><span class="line"><span class="cl">&lt;
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;args&#34;</span>: <span class="o">{}</span>,
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;headers&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Accept&#34;</span>: <span class="s2">&#34;*/*&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Host&#34;</span>: <span class="s2">&#34;httpbin.example.com&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;User-Agent&#34;</span>: <span class="s2">&#34;curl/7.68.0&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;X-Envoy-Internal&#34;</span>: <span class="s2">&#34;true&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;X-Forwarded-Host&#34;</span>: <span class="s2">&#34;httpbin.example.com&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>,
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;origin&#34;</span>: <span class="s2">&#34;172.18.0.1&#34;</span>,
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;url&#34;</span>: <span class="s2">&#34;http://httpbin.example.com/get&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">* Connection <span class="c1">#0 to host httpbin.example.com left intact</span>
</span></span></code></pre></div>
    
  <hr>
    

	
<div class="container flex">
	<ul class="next-prev-icon">

		
		
		<li style="flex:1; text-align: left; white-space: nowrap;"><a href="https://docs.nginx.com/nginx-ingress-controller/tutorials/nginx-ingress-linkerd/" class="" title="Previous -- NGINX Ingress Controller and Linkerd "><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M23.378 46.5L1.94 25.06C1.80067 24.9209 1.69014 24.7556 1.61472 24.5738C1.53931 24.3919 1.50049 24.1969 1.50049 24C1.50049 23.8031 1.53931 23.6081 1.61472 23.4262C1.69014 23.2444 1.80067 23.0791 1.94 22.94L23.378 1.5" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M45.878 46.5L24.44 25.06C24.3007 24.9209 24.1901 24.7556 24.1147 24.5738C24.0393 24.3919 24.0005 24.1969 24.0005 24C24.0005 23.8031 24.0393 23.6081 24.1147 23.4262C24.1901 23.2444 24.3007 23.0791 24.44 22.94L45.878 1.5" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a></li>
		

		
			<li style="flex:1; text-align: right; white-space: nowrap;"><a href="https://docs.nginx.com/nginx-ingress-controller/tutorials/nginx-dynamic-module/" class="" title="Next -- Using NGINX Ingress Controller with NGINX Dynamic Modules"><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M24.622 1.5L46.06 22.94C46.1993 23.0791 46.3099 23.2444 46.3853 23.4262C46.4607 23.6081 46.4995 23.8031 46.4995 24C46.4995 24.1969 46.4607 24.3919 46.3853 24.5738C46.3099 24.7556 46.1993 24.9209 46.06 25.06L24.622 46.5" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M2.122 1.5L23.56 22.94C23.6993 23.0791 23.8099 23.2444 23.8853 23.4262C23.9607 23.6081 23.9995 23.8031 23.9995 24C23.9995 24.1969 23.9607 24.3919 23.8853 24.5738C23.8099 24.7556 23.6993 24.9209 23.56 25.06L2.122 46.5" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a></li>
		
		</ul>
	</div>

    
  </main>
  
    
      <div class="col-md-3 d-none d-xl-block d-print-none nginx-toc align-top" style="width: 25%;">
      <nav class="bd-links" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <h3 class="bd-toc-link">What's on This Page</h3>
    
      
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#mark-the-f5-nginx-ingress-controller-namespace-for-sidecar-injection">Mark the F5 NGINX Ingress controller namespace for sidecar injection</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#helm-installs">Helm installs</a></li>
    <li><a href="#manifest-installs">Manifest installs</a>
      <ul>
        <li><a href="#sample-deployment-file-with-required-annotation">Sample deployment file with required annotation</a></li>
        <li><a href="#install-a-test-application">Install a Test Application</a></li>
        <li><a href="#verify-that-the-envoy-sidecar-has-been-injected-into-nginx-ingress-controller">Verify that the envoy sidecar has been <em>injected</em> into NGINX Ingress Controller</a></li>
      </ul>
    </li>
    <li><a href="#using-the-open-service-mesh-ingressbackend-proxy-feature">Using The Open Service Mesh <code>ingressBackend</code> &ldquo;proxy&rdquo; Feature</a></li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#install-a-test-application-1">Install a Test Application</a></li>
        <li><a href="#mtls-setup">mTLS Setup</a></li>
      </ul>
    </li>
  </ul>
</nav>
      
    
  </div>
</nav>
      </div>
    
  
</div>





  </div>

  <footer>

    
    <footer id="footer">
   <div class="container-fluid">

       <div class="row align-items-center">

         <div class="col-md-6 d-md-flex">
             <img class="nginx-logo-footer" src="https://docs.nginx.com/images/icons/NGINX-Part-of-F5-horiz-all-white-525x208@2x.png"/>
         </div>

         
         <div class="col-md d-flex footer-text">
           <div class="col-xl d-none d-md-block align-self-center text-semibold align-right">
             <span>Found a bug? Looking for something new?</span>
           </div>
           <div class="col-lg d-none d-md-block pl-0">
             <button class="button footer-button"><a href="https://docs.nginx.com/feedback/" alt="Select if you have feedback">Let Us Know</a></button>
           </div>
         </div>
         

       </div>


       
       <div class="row d-print-none d-none d-md-flex">
         <div class="col-md-3 d-none d-md-block">
           <span class="footer-head">Company</span>
           <ul class="footer-text">
             <li><a href="https://www.f5.com/go/product/welcome-to-nginx" target="_blank" alt="Select to learn about F5 NGINX">About F5 NGINX</a></li>
             <li><a href="https://www.f5.com/company/events" target="_blank" alt="Select to learn about F5 events">Events</a></li>
           </ul>
           <br />
           <span class="footer-head">Resources</span>
           <ul class="footer-text">
             <li><a href="https://www.f5.com/company/blog/nginx" target="_blank" alt="Select to visit the F5 NGINX blog" >Blog</a></li>
             <li><a href="https://www.f5.com/go/faq/nginx-faq" target="_blank" alt="Select to visit the F5 NGINX frequently asked questions page" >FAQ</a></li>
             <li><a href="https://www.f5.com/services" target="_blank" alt="Select to learn about F5 NGINX Support">Professional Services</a></li>
             <li><a href="https://www.f5.com/learn/training" target="_blank" alt="Select to learn about F5 training offerings" >Training</a></li>
           </ul>
         </div>

         <div class="col-md-3 d-none d-md-block">
           <span class="footer-head">Products</span>
             <ul class="footer-text">
                 <li><a title="F5 NGINX Plus" aria-label="F5 NGINX Plus" href="https://www.f5.com/products/nginx/nginx-plus">F5 NGINX Plus</a></li>
                 <li><a title="F5 NGINX App Protect" aria-label="F5 NGINX App Protect" href="https://www.f5.com/products/nginx/nginx-app-protect">F5 NGINX App Protect</a></li>
                 <li><a title="F5 NGINX Instance Manager" aria-label="F5 NGINX Instance Manager" href="https://www.f5.com/products/nginx/instance-manager">F5 NGINX Instance Manager</a></li>
                 <li><a title="F5 NGINX Ingress Controller" aria-label="F5 NGINX Ingress Controller" href="https://www.f5.com/products/nginx/nginx-ingress-controller">F5 NGINX Ingress Controller</a></li>
                 <li><a title="F5 NGINX Gateway Fabric" aria-label="F5 NGINX Gateway Fabric" href="https://www.f5.com/products/nginx/nginx-gateway-fabric">F5 NGINX Gateway Fabric</a></li>
                 <li><a title="F5 NGINXaaS for Azure" aria-label="F5 NGINXaaS for Azure" href="https://www.f5.com/products/nginx/f5-nginxaas-for-azure">F5 NGINXaaS for Azure</a></li>
             </ul>
         </div>

         <div class="col-md-3 d-none d-md-block">
           <span class="footer-head">NGINX on GitHub</span>
           <ul class="footer-text">
             <li><a title="NGINX Open Source" aria-label="NGINX Open Source" href="https://github.com/nginx/nginx"><span class="inner">NGINX Open Source</span></a></li>
             <li><a title="NGINX Unit" aria-label="NGINX Unit" href="https://github.com/nginx/unit"><span class="inner">NGINX Unit</span></a></li>
             <li><a title="NGINX Amplify" aria-label="NGINX Amplify" href="https://github.com/nginxinc/nginx-amplify-agent"><span class="inner">NGINX Amplify</span></a></li>
             <li><a title="NGINX Agent" aria-label="NGINX Agent" href="https://github.com/nginx/Agent"><span class="inner">NGINX Agent</span></a></li>
             <li><a title="NGINX Kubernetes Ingress Controller" aria-label="NGINX Kubernetes Ingress Controller" href="https://github.com/nginxinc/kubernetes-ingress"><span class="inner">NGINX Kubernetes Ingress Controller</span></a></li>
             <li><a title="NGINX Gateway Fabric" aria-label="NGINX Gateway Fabric" href="https://github.com/nginxinc/nginx-gateway-fabric"><span class="inner">NGINX Gateway Fabric</span></a></li>
         </ul>
         </div>

         <div class="col-md-2 d-none d-md-block">
           <span class="footer-head">Social</span>
               <ul class="footer-social">
                 <li><a href="https://www.facebook.com/nginxinc" title="facebook" aria-label="facebook" target="_blank" rel="noreferrer"><i class="fa-brands fa-facebook" aria-hidden="true"></i>
                  </a></li>
                 <li><a href="https://twitter.com/nginx" title="X" aria-label="x" target="_blank" rel="noreferrer"><i class="fa-brands fa-x-twitter" aria-hidden="true"></i></a></li>
                 <li><a href="https://www.linkedin.com/company/nginx" title="linkedin" aria-label="linkedin" target="_blank" rel="noreferrer"><i class="fa-brands fa-linkedin" aria-hidden="true"></i>
                  </a></li>
                 <li><a href="https://www.youtube.com/user/NginxInc" title="youtube" aria-label="youtube" target="_blank" rel="noreferrer" alt="NGINX Youtube Channel"><i class="fa-brands fa-square-youtube" aria-hidden="true"></i>
                  </a></li>
               </ul>
         </div>
       </div>
       
       <div class="site-info footer-text">

           <div class="text-center">
           <p><a href="https://www.f5.com/"><img class="f5-logo-footer" src="https://docs.nginx.com/images/icons/Logo_F5.svg" alt="F5 logo"></a>
              ©2024 F5, Inc. All rights reserved.</p><p><a href="https://www.f5.com/company/policies/trademarks" rel="noopener" target="_blank">Trademarks</a>  <a href="https://www.f5.com/company/policies" rel="noopener" target="_blank">Policies</a> <a href="https://docs.nginx.com/ossc">Open Source Components</a>  <a href="https://www.f5.com/company/policies/privacy-notice" rel="noopener" target="_blank">Privacy</a>  <a href="https://www.f5.com/company/policies/F5-California-privacy-summary" rel="noopener" target="_blank">California Privacy</a>  <a href="https://www.f5.com/company/policies/privacy-notice#no-sell" rel="noopener" target="_blank">Do Not Sell My Personal Information</a>  <span id="teconsent"></span></p>
           </div>

       </div>
   </div>
</footer>

    

  </footer>


<script src="/nginx-ingress-controller/js/jquery-3-6-4.min.js" type="text/javascript" integrity=""></script>


<script src="/nginx-ingress-controller/js/kube.min.a3a07cceb64989e2f0bf41653ab4d8346ba4312270eb5cc80d6afad3bf30a0ca9768aaa2559cb582e663332c541edab6a4068ef2e88b739fa425e2e870eb0aff.js" type="text/javascript" integrity="sha512-o6B8zrZJieLwv0FlOrTYNGukMSJw61zIDWr6078woMqXaKqiVZy1guZjMyxUHtq2pAaO8uiLc5&#43;kJeLocOsK/w=="></script>



<script src="/nginx-ingress-controller/js/bootstrap.bundle.min.c15ed88f56a52190ea645094409cbce5537eaaf108972f777c840037b8aa0c508f12e70b09e345cf8af7e450a8f6ce96ae974340f8bcd316e58d707c063b6f72.js" type="text/javascript" integrity="sha512-wV7Yj1alIZDqZFCUQJy85VN&#43;qvEIly93fIQAN7iqDFCPEucLCeNFz4r35FCo9s6WrpdDQPi80xbljXB8Bjtvcg=="></script>



<script src="/nginx-ingress-controller/js/code-copy.b424b9cf3f8a69320d1a74e5b4345962141999ae58795c39fb9c5ac8953f3aef3373d7a334971f578e4dc4ee212cbe8f42951d16edb285e6a7931634998d900c.js" type="text/javascript" ></script>





<script class="coveo-script" src="https://static.cloud.coveo.com/searchui/v2.10104/0/js/CoveoJsSearch.Lazy.min.js" integrity="sha512-HxdDBIp5snbqtu1TPkBnXLKEvN9IPz3PeZW8zT9KfsflV9Ck822XDroDlpVbfCfXeiu8C0RDVn0fdu7aGy/H1g==" crossorigin="anonymous"></script>

<script src="https://static.cloud.coveo.com/searchui/v2.10104/0/js/templates/templates.js" integrity="sha512-CR0Yk/LIwgh1MsKqjecDp/r6F9ipKc6gA+4+E1pplT3N3r1pk+la/HaqyDiKtjOFwrwIIbIYBFrUJgPql93QHw==" crossorigin="anonymous"></script>






<script src="/nginx-ingress-controller/js/coveo.min.6e0e2c15ea8204cc128d34f0e7e13d16783166196b052d33cb05ec26a38415801ab03141a36256976745037faedb2da32dd8f3600b92b5f3c7d22fa634b0624f.js" integrity="sha512-bg4sFeqCBMwSjTTw5&#43;E9FngxZhlrBS0zywXsJqOEFYAasDFBo2JWl2dFA3&#43;u2y2jLdjzYAuStfPH0i&#43;mNLBiTw==" type="text/javascript"></script>






  
  

  
  





<script src="/nginx-ingress-controller/js/sidebar.min.89a78ac76492f78b44370cf6bbaa09457606d00a4b14db603de939e128451bf31bd29e46c179fbc3a1d632302f5ebfe61c5b9e65e2c171acd4981185cd3329b6.js" type="text/javascript" integrity="sha512-iaeKx2SS94tENwz2u6oJRXYG0ApLFNtgPek54ShFG/Mb0p5GwXn7w6HWMjAvXr/mHFueZeLBcazUmBGFzTMptg=="></script>
 
<div id="consent_blackbar" style="position:fixed;top:0px;width:100%"></div>
</body>
</html>


